/* devcast.co v1.0.0 - 2014/6/30
   http://tapquo.com
   Copyright (c) 2014 undefined <undefined> - Licensed  */
(function(){"use strict";var a,b,c,d,e,f,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=[].slice,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k=function(a,b){return function(){return a.apply(b,arguments)}};d=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return d=[],h=Object.prototype,g=/^\s*<(\w+|!)[^>]*>/,c=[1,9,11],b=/^\.([\w-]+)$/,f=/^#[\w\d-]+$/,k=/^[\w-]+$/,i=document.createElement("table"),j=document.createElement("tr"),e={tr:document.createElement("tbody"),tbody:i,thead:i,tfoot:i,td:j,th:j,"*":document.createElement("div")},a=function(b,c){var d;return b?"function"===a.toType(b)?a(document).ready(b):(d=o(b,c),p(d,b)):p()},a.query=function(a,c){var d;return b.test(c)?d=a.getElementsByClassName(c.replace(".","")):k.test(c)?d=a.getElementsByTagName(c):f.test(c)&&a===document?(d=a.getElementById(c.replace("#","")),d||(d=[])):d=a.querySelectorAll(c),d.nodeType?[d]:Array.prototype.slice.call(d)},a.extend=function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){var c,d;d=[];for(c in b)d.push(a[c]=b[c]);return d}),a},a.toType=function(a){return h.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},a.each=function(b,c){var d,e,f,g,h;if(e=void 0,f=void 0,"array"===a.toType(b))for(e=g=0,h=b.length;h>g;e=++g)d=b[e],c.call(d,e,d)===!1;else for(f in b)c.call(b[f],f,b[f])===!1;return b},a.map=function(b,c){var d,e,f,g;if(g=[],d=void 0,e=void 0,"array"===a.toType(b))for(d=0;d<b.length;)f=c(b[d],d),null!=f&&g.push(f),d++;else for(e in b)f=c(b[e],e),null!=f&&g.push(f);return m(g)},a.mix=function(){var a,b,c,d,e;for(c={},a=0,d=arguments.length;d>a;){b=arguments[a];for(e in b)q(b,e)&&void 0!==b[e]&&(c[e]=b[e]);a++}return c},p=function(a,b){return null==b&&(b=""),a=a||d,a.selector=b,a.__proto__=p.prototype,a},o=function(b,d){var e,f;return e=null,f=a.toType(b),"array"===f?e=l(b):"string"===f&&g.test(b)?(e=n(b.trim(),RegExp.$1),b=null):"string"===f?(e=a.query(document,b),d&&(e=1===e.length?a.query(e[0],d):a.map(function(){return a.query(e,d)}))):(c.indexOf(b.nodeType)>=0||b===window)&&(e=[b],b=null),e},n=function(b,c){var d;return null==c&&(c="*"),c in e||(c="*"),d=e[c],d.innerHTML=""+b,a.each(Array.prototype.slice.call(d.childNodes),function(){return d.removeChild(this)})},l=function(a){return a.filter(function(a){return null!=a?a:void 0})},m=function(a){return a.length>0?d.concat.apply(d,a):a},q=function(a,b){return h.hasOwnProperty.call(a,b)},p.prototype=a.fn={},a.fn.each=function(a){return this.forEach(function(b,c){return a.call(b,c,b)}),this},a.fn.filter=function(b){return a(d.filter.call(this,function(c){return c.parentNode&&a.query(c.parentNode,b).indexOf(c)>=0}))},a.fn.forEach=d.forEach,a.fn.indexOf=d.indexOf,a}(),this.Quo=this.$$=d,function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return b={TYPE:"GET",MIME:"json"},d={script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},c=0,a.ajaxSettings={type:b.TYPE,async:!0,success:{},error:{},context:null,dataType:b.MIME,headers:{},xhr:function(){return new window.XMLHttpRequest},crossDomain:!1,timeout:0},a.ajax=function(c){var d,g,i,l;if(i=a.mix(a.ajaxSettings,c),i.type===b.TYPE?i.url+=a.serialize(i.data,"?"):i.data=a.serialize(i.data),e(i.url))return f(i);l=i.xhr(),l.onreadystatechange=function(){return 4===l.readyState?(clearTimeout(d),k(l,i)):void 0},l.open(i.type,i.url,i.async),j(l,i),i.timeout>0&&(d=setTimeout(function(){return m(l,i)},i.timeout));try{l.send(i.data)}catch(n){g=n,l=g,h("Resource not found",l,i)}return l},a.get=function(b,c,d,e){return a.ajax({url:b,data:c,success:d,dataType:e})},a.post=function(a,b,c,d){return i("POST",a,b,c,d)},a.put=function(a,b,c,d){return i("PUT",a,b,c,d)},a["delete"]=function(a,b,c,d){return i("DELETE",a,b,c,d)},a.json=function(b,c,d){return a.ajax({url:b,data:c,success:d})},a.serialize=function(a,b){var c,d;null==b&&(b=""),d=b;for(c in a)a.hasOwnProperty(c)&&(d!==b&&(d+="&"),d+=""+encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return d===b?"":d},f=function(b){var d,e,f,g;return b.async?(e="jsonp"+ ++c,f=document.createElement("script"),g={abort:function(){return a(f).remove(),e in window?window[e]={}:void 0}},d=void 0,window[e]=function(c){return clearTimeout(d),a(f).remove(),delete window[e],l(c,g,b)},f.src=b.url.replace(RegExp("=\\?"),"="+e),a("head").append(f),b.timeout>0&&(d=setTimeout(function(){return m(g,b)},b.timeout)),g):console.error("QuoJS.ajax: Unable to make jsonp synchronous call.")},k=function(a,b){a.status>=200&&a.status<300||0===a.status?b.async&&l(g(a,b),a,b):h("QuoJS.ajax: Unsuccesful request",a,b)},l=function(a,b,c){c.success.call(c.context,a,b)},h=function(a,b,c){c.error.call(c.context,a,b,c)},j=function(a,b){var c;b.contentType&&(b.headers["Content-Type"]=b.contentType),b.dataType&&(b.headers.Accept=d[b.dataType]);for(c in b.headers)a.setRequestHeader(c,b.headers[c])},m=function(a,b){a.onreadystatechange={},a.abort(),h("QuoJS.ajax: Timeout exceeded",a,b)},i=function(b,c,d,e,f){return a.ajax({type:b,url:c,data:d,success:e,dataType:f,contentType:"application/x-www-form-urlencoded"})},e=function(a){return RegExp("=\\?").test(a)},g=function(a,c){var d,e;if(e=a,a.responseText){if(c.dataType===b.MIME)try{e=JSON.parse(a.responseText)}catch(f){d=f,e=d,h("QuoJS.ajax: Parse Error",a,c)}"xml"===c.dataType&&(e=a.responseXML)}return e}}(d),function(a){var b,c;return b=["-webkit-","-moz-","-ms-","-o-",""],a.fn.addClass=function(a){return this.each(function(){return this.classList.add(a)})},a.fn.removeClass=function(a){return this.each(function(){return this.classList.remove(a)})},a.fn.toggleClass=function(a){return this.each(function(){var b;return b=this.classList.contains(a)?"remove":"add",this.classList[b](a)})},a.fn.hasClass=function(a){return this.length>0&&this[0].classList.contains(a)},a.fn.listClass=function(){return this.length>0?this[0].classList:void 0},a.fn.style=a.fn.css=function(a,b){var d;return null!=b?this.each(function(){return this.style[a]=b}):(d=this[0],d.style[a]||c(d,a))},a.fn.vendor=function(a,c){var d,e,f,g;for(g=[],e=0,f=b.length;f>e;e++)d=b[e],g.push(this.style(""+d+a,c));return g},c=function(a,b){return document.defaultView.getComputedStyle(a,"")[b]}}(d),function(a){return a.fn.attr=function(b,c){return this.length>0&&"string"===a.toType(b)?c?this.each(function(){return this.setAttribute(b,c)}):this[0].getAttribute(b):void 0},a.fn.removeAttr=function(b){return this.length>0&&"string"===a.toType(b)?this.each(function(){return this.removeAttribute(b)}):void 0},a.fn.data=function(a,b){return this.attr("data-"+a,b)},a.fn.removeData=function(a){return this.removeAttr("data-"+a)},a.fn.val=function(a){return null!=a?this.each(function(){return this.value=a.toString()}):this.length>0?this[0].value:null},a.fn.show=function(){return this.style("display","block")},a.fn.hide=function(){return this.style("display","none")},a.fn.focus=function(){return this[0].focus()},a.fn.blur=function(){return this[0].blur()},a.fn.offset=function(){var a,b;return this.length>0&&(a=this[0].getBoundingClientRect(),b={left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}),b}}(d),function(a){var b,c,d,e,f,g;return d=null,b=/WebKit\/([\d.]+)/,c={Android:/(Android)\s+([\d.]+)/,ipad:/(iPad).*OS\s([\d_]+)/,iphone:/(iPhone\sOS)\s([\d_]+)/,Blackberry:/(BlackBerry|BB10|Playbook).*Version\/([\d.]+)/,FirefoxOS:/(Mozilla).*Mobile[^\/]*\/([\d\.]*)/,webOS:/(webOS|hpwOS)[\s\/]([\d.]+)/},a.isMobile=function(){return this.environment(),d.isMobile},a.environment=function(){var a,b;return d||(b=navigator.userAgent,a=f(b),d={browser:e(b),isMobile:!!a,screen:g(),os:a}),d},e=function(a){var c;return c=a.match(b),c?c[0]:a},f=function(a){var b,d,e;for(d in c)if(e=a.match(c[d])){b={name:"iphone"===d||"ipad"===d||"ipod"===d?"ios":d,version:e[2].replace("_",".")};break}return b},g=function(){return{width:window.innerWidth,height:window.innerHeight}}}(d),function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return b=1,e={},d={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},c={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touch:"click",orientationchange:"resize"},f=/complete|loaded|interactive/,a.fn.on=function(b,c,d){return null==c||"function"===a.toType(c)?this.bind(b,c):this.delegate(c,b,d)},a.fn.off=function(b,c,d){return null==c||"function"===a.toType(c)?this.unbind(b,c):this.undelegate(c,b,d)},a.fn.ready=function(b){return f.test(document.readyState)?b.call(this,a):a.fn.addEvent(document,"DOMContentLoaded",function(){return b.call(this,a)})},a.fn.bind=function(a,b){return this.each(function(){return m(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){return n(this,a,b)})},a.fn.delegate=function(b,c,d){return this.each(function(e,f){return m(f,c,d,b,function(c){return function(d){var e,h;return h=a(d.target).closest(b,f).get(0),h?(e=a.extend(g(d),{currentTarget:h,liveFired:f}),c.apply(h,[e].concat([].slice.call(arguments,1)))):void 0}})})},a.fn.undelegate=function(a,b,c){return this.each(function(){return n(this,b,c,a)})},a.fn.trigger=function(b,c,d){return"string"===a.toType(b)&&(b=j(b,c)),null!=d&&(b.originalEvent=d),this.each(function(){return this.dispatchEvent(b)})},a.fn.addEvent=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},a.fn.removeEvent=function(a,b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null},j=function(a,b){var c;return c=document.createEvent("Events"),c.initEvent(a,!0,!0,null,null,null,null,null,null,null,null,null,null,null,null),b&&(c.quoData=b),c},m=function(b,c,d,f,g){var j,k,m,n;return c=i(c),m=l(b),k=e[m]||(e[m]=[]),j=g&&g(d,c),n={event:c,callback:d,selector:f,proxy:h(j,d,b),delegate:j,index:k.length},k.push(n),a.fn.addEvent(b,n.event,n.proxy)},n=function(b,c,d,f){var g;return c=i(c),g=l(b),k(g,c,d,f).forEach(function(c){return delete e[g][c.index],a.fn.removeEvent(b,c.event,c.proxy)})},l=function(a){return a._id||(a._id=b++)},i=function(b){var d;return d=("function"==typeof a.isMobile?a.isMobile():void 0)?b:c[b],d||b},h=function(a,b,c){var d;return b=a||b,d=function(a){var d;return d=b.apply(c,[a].concat(a.data)),d===!1&&a.preventDefault(),d}},k=function(a,b,c,d){return(e[a]||[]).filter(function(a){return!(!a||b&&a.event!==b||c&&a.callback!==c||d&&a.selector!==d)})},g=function(b){var c;return c=a.extend({originalEvent:b},b),a.each(d,function(a,d){return c[a]=function(){return this[d]=function(){return!0},b[a].apply(b,arguments)},c[d]=function(){return!1}}),c}}(d),d.Gestures=function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o,p;return p=!1,l={},i=null,n=null,f=["input","select","textarea"],a(document).ready(function(){var b;return b=a(document.body),b.bind("touchstart",o),b.bind("touchmove",m),b.bind("touchend",h),b.bind("touchcancel",e)}),b=function(a){return l[a.name]=a.handler,d(a.events)},c=function(b,c,d){return a(b).trigger(c,d,n)},o=function(a){var b;return b=(a.srcElement||a.target).tagName.toLowerCase(),g.call(f,b)>=0?a.stopPropagation():(p=!0,n=a||event,i=j(a),k("start",a.target,i))},m=function(a){return p?(n=a||event,i=j(a),i.length>1&&n.preventDefault(),k("move",a.target,i)):void 0},h=function(a){return p?(n=a||event,k("end",a.target,i),p=!1):void 0},e=function(){return p=!1,k("cancel")},d=function(b){return b.forEach(function(b){return a.fn[b]=function(c){return a(document.body).delegate(this.selector,b,c)}}),this},k=function(a,b,c){var d,e,f;f=[];for(e in l)d=l[e],d[a]&&f.push(d[a].call(d,b,c));return f},j=function(a){var b,c,d,e,f;for(e=a.touches||[a],f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push({x:b.pageX,y:b.pageY});return f},{add:b,trigger:c}}(d),d.Gestures.add({name:"basic",events:["touch","hold","doubleTap"],handler:function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return c=15,b={TAP:200,DOUBLE_TAP:400,HOLD:400},i=null,m=!0,l=null,k=null,j=null,g=function(c,e){return 1===e.length?(k={time:new Date,x:e[0].x,y:e[0].y},l=c,i=setTimeout(function(){return a.trigger(c,"hold",e[0])},b.HOLD)):d()},f=function(a,b){var e;return null!==k&&(e=h(k,b[0]),e.x>c||e.y>c||b.length>1)?d():void 0},e=function(c,e){var f,g;return k?(f=h(k,e[0]),0!==f.x||0!==f.y?d():(clearTimeout(i),g=new Date,g-k.time<b.TAP?g-j<b.DOUBLE_TAP?(a.trigger(c,"doubleTap",e[0]),j=null):(j=g,a.trigger(c,"touch",e[0])):void 0)):void 0},d=function(){return k=null,m=!1,clearTimeout(i)},h=function(a,b){var c;return c={x:b.x-a.x,y:b.y-a.y}},{start:g,move:f,end:e,cancel:d}}(d.Gestures)}),d.Gestures.add({name:"drag",events:["drag","dragging"],handler:function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return b=window.devicePixelRatio>=2?15:20,m=null,k=null,l=null,j=null,f=function(a,b){return b.length>=2?(m=a,k=b.length,l=g(b)):void 0},e=function(a,b){var c;return b.length===k?(c=h(b),j={touches:b,delta:c},i(!0)):void 0},c=d=function(){return l&&j?(i(!1),k=null,l=null,j=null):void 0},h=function(a){var b;return b=g(a),{x:b.x-l.x,y:b.y-l.y}},g=function(a){var b,c,d,e,f;for(c=0,d=0,e=0,f=a.length;f>e;e++)b=a[e],c+=parseInt(b.x),d+=parseInt(b.y);return{x:c/a.length,y:d/a.length}},i=function(c){return c?a.trigger(m,"dragging",j):Math.abs(j.delta.x)>b||Math.abs(j.delta.y)>b?a.trigger(m,"drag",j):void 0},{start:f,move:e,end:d}}(d.Gestures)}),d.Gestures.add({name:"pinch",events:["pinch","pinching","pinchIn","pinchOut"],handler:function(a){var b,c,d,e,f,g,h,i,j,k;return b=window.devicePixelRatio>=2?15:20,k=null,j=null,i=null,f=function(a,b){return 2===b.length?(k=a,j=h(b[0],b[1])):void 0},e=function(a,b){var c;return j&&2===b.length?(c=h(b[0],b[1]),i={touches:b,delta:c-j},g(!0)):void 0},c=d=function(){return j&&i?(g(!1),j=null,i=null):void 0},h=function(a,b){return Math.sqrt((b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y))},g=function(c){var d;return c?a.trigger(k,"pinching",i):Math.abs(i.delta)>b?(a.trigger(k,"pinch",i),d=i.delta>0?"pinchOut":"pinchIn",a.trigger(k,d,i)):void 0},{start:f,move:e,end:d}}(d.Gestures)}),d.Gestures.add({name:"rotation",events:["rotate","rotating","rotateLeft","rotateRight"],handler:function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return b=5,c=20,m=null,i=0,l=null,h=null,f=function(a,b){return 2===b.length?(m=a,i=0,l=j(b[0],b[1])):void 0},e=function(a,b){var d;return l&&2===b.length?(d=j(b[0],b[1])-l,h&&Math.abs(h.delta-d)>c&&(d+=360*k(h.delta)),Math.abs(d)>360&&(i++,d-=360*k(h.delta)),h={touches:b,delta:d,rotationsCount:i},g(!0)):void 0},d=function(){return l&&h?(g(!1),m=null,i=0,l=null,h=null,l=null):void 0},k=function(a){return 0>a?-1:1},j=function(a,b){var c;return c=Math.atan2(a.y-b.y,a.x-b.x),180*(0>c?c+2*Math.PI:c)/Math.PI},g=function(c){var d;return c?a.trigger(m,"rotating",h):Math.abs(h.delta)>b?(a.trigger(m,"rotate",h),d=h.delta>0?"rotateRight":"rotateLeft",a.trigger(m,d,h)):void 0},{start:f,move:e,end:d}}(d.Gestures)}),d.Gestures.add({name:"swipe",events:["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","swiping","swipingHorizontal","swipingVertical"],handler:function(a){var b,c,d,e,f,g,h,i,j,k,l;return b=Math.round(20/window.devicePixelRatio),l=null,j=null,k=null,i=null,f=function(a,b){return 1===b.length?(l=a,j=b[0],i=null):void 0},e=function(a,b){var c,d;return 1===b.length?(c={x:b[0].x-j.x,y:b[0].y-j.y},d=null===i,i={x:b[0].x,y:b[0].y,delta:c},g(!0,d)):i=null},c=d=function(a,b){var c;return null==i&&b.length>=1&&(c={x:b[0].x-j.x,y:b[0].y-j.y},i={x:b[0].x,y:b[0].y,delta:c}),i?(g(!1),i=null):void 0},g=function(c,d){var e,f,g,j,m;if(null==d&&(d=!1),c)return d&&(k=h(i.delta.x,i.delta.y)),null!==k&&a.trigger(l,"swiping"+k,i),a.trigger(l,"swiping",i);if(f=[],Math.abs(i.delta.y)>b?f.push(i.delta.y<0?"Up":"Down"):Math.abs(i.delta.x)>b&&f.push(i.delta.x<0?"Left":"Right"),f.length){for(a.trigger(l,"swipe",i),m=[],g=0,j=f.length;j>g;g++)e=f[g],m.push(a.trigger(l,"swipe"+e,i));return m}},h=function(a,b){var c;return c=null,Math.round(Math.abs(a/b))>=2?c="Horizontal":Math.round(Math.abs(b/a))>=2&&(c="Vertical"),c},{start:f,move:e,end:d}}(d.Gestures)}),function(a){return a.fn.text=function(a){return null!=a?this.each(function(){return this.textContent=a}):this.length>0?this[0].textContent:""},a.fn.html=function(b){var c;return null!=b?(c=a.toType(b),this.each(function(){return"string"===c?this.innerHTML=b:"array"===c?b.forEach(function(b){return function(c){return a(b).html(c)}}(this)):this.innerHTML+=a(b).html()})):this.length>0?this[0].innerHTML:""},a.fn.remove=function(){return this.each(function(){return null!=this.parentNode?this.parentNode.removeChild(this):void 0})},a.fn.empty=function(){return this.each(function(){return this.innerHTML=null})},a.fn.append=function(b){var c;return c=a.toType(b),this.each(function(){return"string"===c?this.insertAdjacentHTML("beforeend",b):"array"===c?b.forEach(function(b){return function(c){return a(b).append(c)}}(this)):this.appendChild(b)})},a.fn.prepend=function(b){var c;return c=a.toType(b),this.each(function(){return"string"===c?this.insertAdjacentHTML("afterbegin",b):"array"===c?b.each(function(a){return function(b,c){return a.insertBefore(c,a.firstChild)}}(this)):this.insertBefore(b,this.firstChild)})},a.fn.replaceWith=function(b){var c;return c=a.toType(b),this.each(function(){return this.parentNode?"string"===c?this.insertAdjacentHTML("beforeBegin",b):"array"===c?b.each(function(a){return function(b,c){return a.parentNode.insertBefore(c,a)}}(this)):this.parentNode.insertBefore(b,this):void 0}),this.remove()}}(d),function(a){var b,c,e,f;return b="parentNode",a.fn.find=function(b){var c;return c=1===this.length?d.query(this[0],b):this.map(function(){return d.query(this,b)}),a(c)},a.fn.parent=function(a){var d;return d=a?e(this):this.instance(b),c(d,a)},a.fn.children=function(a){var b;return b=this.map(function(){return Array.prototype.slice.call(this.children)}),c(b,a)},a.fn.siblings=function(a){var b;return b=this.map(function(a,b){return Array.prototype.slice.call(b.parentNode.children).filter(function(a){return a!==b})}),c(b,a)},a.fn.get=function(a){return this[a]||null},a.fn.first=function(){return a(this[0])},a.fn.last=function(){return a(this[this.length-1])},a.fn.closest=function(b,c){var d,e;for(e=this[0],d=a(b),d.length||(e=null);e&&d.indexOf(e)<0;)e=e!==c&&e!==document&&e.parentNode;return a(e)},a.fn.next=function(){return f.call(this,"nextSibling")},a.fn.prev=function(){return f.call(this,"previousSibling")},a.fn.instance=function(a){return this.map(function(){return this[a]})},a.fn.map=function(b){return a.map(this,function(a,c){return b.call(a,c,a)})},e=function(b){var c;for(c=[];b.length>0;)b=a.map(b,function(a){return a=a.parentNode,a!==document&&c.indexOf(a)<0?(c.push(a),a):void 0});return c},c=function(b,c){return null!=c?a(b).filter(c):a(b)},f=function(b){var c;for(c=this[0][b];c&&1!==c.nodeType;)c=c[b];return a(c)}}(d),a=this.Atoms={version:"0.06.23b",Core:{},Class:{},Atom:{},Molecule:{},Organism:{},Entity:{},$:function(){var a;return a=1<=arguments.length?h.call(arguments,0):[],"undefined"!=typeof $$&&null!==$$?$$.apply(null,a):$.apply(null,a)}},a.Core.Children={"default":{children:[]},chemistry:function(){var a,b,c,d,e,f,g;for(f=this.attributes.children||(null!=(e=this.constructor["default"])?e.children:void 0)||[],g=[],c=0,d=f.length;d>c;c++)b=f[c],g.push(function(){var c;c=[];for(a in b)c.push(this.appendChild(a,b[a]));return c}.call(this));return g},appendChild:function(b,c){var d,e;return null==c&&(c={}),e=b.toClassObject(a),e?this.__available(e)?(null!=e["default"]&&(c=a.Core.Helper.mix(c,e["default"])),c.parent=c.parent||this,d=new e(c),this.children.push(d),c.id&&(this[c.id]=d),d):console.error("Instance "+b+" not available in "+this.constructor.type+"."+this.constructor.base+" #"+this.constructor.name+"."):console.error("Instance "+b+" doesn't exists.")},destroyChildren:function(){var a,b,c,d;for(d=this.children||[],b=0,c=d.length;c>b;b++)a=d[b],"function"==typeof a.destroy&&a.destroy();return this.children=[]},__available:function(a){var b;return b=""+a.type+"."+(a.base||a.name),!this.constructor.available||g.call(this.constructor.available,b)>=0}},a.Core.Constants={ANIMATION:{END:"webkitAnimationEnd MSAnimationEnd animationend"},APPEND:"append",EXCLUDED_IF_KEYS:["class","entity","events","if","parent","children"],ENTITY:{EVENT:{CREATE:"create",UPDATE:"update",DESTROY:"destroy"}}},a.Core.Event={bindings:null,bind:function(a,b){var c,d,e,f,g;for(a=a.split(" "),this.events=this.events||{},g=[],e=0,f=a.length;f>e;e++)c=a[e],c=this._customEventName(c),(d=this.events)[c]||(d[c]=[]),g.push(this.events[c].push(b));return g},unbind:function(a,b){var c;return a=this._customEventName(a),this.hasOwnProperty("events")&&(null!=(c=this.events)?c[a]:void 0)?this.events[a].splice(this.events[a].indexOf(b),1):void 0},trigger:function(){var a,b,c,d,e,f,g;if(b=arguments[0],a=2<=arguments.length?h.call(arguments,1):[],b=this._customEventName(b),c=this.hasOwnProperty("events")&&null!=(f=this.events)?f[b]:void 0){for(a.push(this),g=[],d=0,e=c.length;e>d&&(b=c[d],b.apply(this,a)!==!1);d++)g.push(void 0);return g}},bubble:function(){var a,b,c,d;return b=arguments[0],c=2<=arguments.length?h.call(arguments,1):[],a=!0,1===c.length&&g.call(this.attributes.events||[],b)<0&&(a=!1),a&&null!=(null!=(d=this.parent)?d.uid:void 0)?(c.push(this),this._state(this.parent,b,c,"bubble")):void 0},tunnel:function(){var a,b,c,d,e,f,g,i;if(c=arguments[0],a=2<=arguments.length?h.call(arguments,1):[],(null!=(f=this.children)?f.length:void 0)>0){for(a.push(this),g=this.children,i=[],d=0,e=g.length;e>d;d++)b=g[d],null!=b.uid&&i.push(this._state(b,c,a,"tunnel"));return i}},_customEventName:function(a){var b;return b=this._base(this.constructor),(""+this.constructor.type+":"+b+":"+a).toLowerCase()},_base:function(a){return a.base||a.name},_state:function(a,b,c,d){var e,f,g,h,i,j,k;return null==d&&(d="bubble"),"bubble"===d?(h=null!=(i=this.attributes.events)?i.indexOf(b):void 0,h>-1&&(f=null!=(j=this.attributes.callbacks)?j[h]:void 0,f&&(c[0].eventCustomCallback=f)),f||(f=c[0].eventCustomCallback),f||(g=1===c.length?this.constructor:c[1].constructor,e=this._base(g),g["extends"]&&(e=g.name),f="on"+e.toClassName()+b.toClassName())):"tunnel"===d&&(f=b),c[0].eventType=d,(null!=(k=a[f])?k.apply(a,c):void 0)!==!1?a[d].apply(a,[b].concat(c)):void 0}},a.Core.Helper=function(){var a,b;return b=function(a,b){var c,d;if(c=this._clone(b),null!=c)for(d in a)c[d]="object"==typeof a[d]?this.mix(a[d],c[d]):a[d];else c=a;return c},a=function(a){return"[object Array]"==={}.toString.call(a)},{_clone:function(a){var b,c,d;if(null==a||"object"!=typeof a)return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return b="",null!=a.global&&(b+="g"),null!=a.ignoreCase&&(b+="i"),null!=a.multiline&&(b+="m"),null!=a.sticky&&(b+="y"),new RegExp(a.source,b);d=new a.constructor;for(c in a)d[c]=this._clone(a[c]);return d},mix:b,isArray:a}}(),String.prototype.toClassName=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.toClassObject=function(a){var b,c,d,e;for(c=this.split("."),a||(a=window[c[0]],c.shift()),d=0,e=c.length;e>d;d++)b=c[d],null!=a&&(a=a[b]);return a},c=["included","extended"],a.Core.Module=function(){function a(){this.uid=e()}return a.extend=function(a){var b,d,e;if(!a)throw new Error("extend(obj) requires obj");for(b in a)d=a[b],g.call(c,b)<0&&(this[b]=d);return null!=(e=a.extended)&&e.apply(this),this},a.include=function(a){var b,d,e;if(!a)throw new Error("include(obj) requires obj");for(d in a)e=a[d],g.call(c,d)<0&&(this.prototype[d]=e);return b=a.included,b&&b.apply(this),this},a.create=function(a,b){var c;return c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b}(this),a&&c.include(a),b&&c.extend(b),c},a}(),e=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b,c;return b=16*Math.random()|0,c="x"===a?b:3&b|8,c.toString(16)}).toUpperCase()},a.Core.Output={append:function(){return this.output("append")},prepend:function(){return this.output("prepend")},html:function(){return this.output("html")},output:function(){if(null==this.constructor.template)throw"No template defined.";if(null==this.container)throw"No container assigned.";return this._render(),this.constructor.method=this.attributes.method||a.Core.Constants.APPEND,("string"==typeof this.container||null==this.container.length)&&(this.container=a.$(this.container)),this.container.first()[this.constructor.method](this.el)},refresh:function(a){var b,c,d;null==a&&(a={});for(c in a)d=a[c],this.attributes[c]=d;return b=this.el,this._render(),"function"==typeof this.bindEvents&&this.bindEvents(),b.replaceWith(this.el)},destroy:function(){return this.el.remove()},_render:function(){var b;return this._createIfBindings(),this.el=a.$(f(this.constructor.template)(this.attributes)),b=this.constructor.base||new String,this.el.attr("data-"+this.constructor.type,b.toLowerCase()),this.constructor.name.toLowerCase()!==b.toLowerCase()&&this.el.attr("data-extend",this.constructor.name.toLowerCase()),this.el},_createIfBindings:function(){var b,c;this.attributes["if"]={},c=[];for(b in this.attributes)g.call(a.Core.Constants.EXCLUDED_IF_KEYS,b)<0&&c.push(this.attributes[b]?this.attributes["if"][b]=!0:void 0);return c}},f=function(a){var b,c,d,e;return c=function(a,b){var c,d,e;for(b=1,a=a.replace(/\.\.\//g,function(){return b++,""}),d=["data[data.length - ",b,"]"],e="."===a?[]:a.split("."),c=0;c<e.length;)d.push("."+e[c]),c++;return d.join("")},e=function(a){return a.replace(/\{\{(!|&|\{)?\s*(.*?)\s*}}+/g,function(a,b,e){var f;return"!"===b?"":(f=d++,['"; var o',f," = ",c(e),", s",f," = (((typeof(o",f,') == "function" ? o',f,".call(data[data.length - 1]) : o",f,') || "") + ""); s += ',b?"s"+f:'(/[&"><]/.test(s'+f+") ? s"+f+'.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;") : s'+f+")",' + "'].join(""))})},b=function(a){return e(a.replace(/\{\{(\^|#)(.*?)}}(.*?)\{\{\/\2}}/g,function(a,e,f,g){var h;return h=d++,['"; var o',h," = ",c(f),"; ",("^"===e?["if ((o",h," instanceof Array) ? !o",h,".length : !o",h,') { s += "',b(g),'"; } ']:["if (typeof(o",h,') == "boolean" && o',h,') { s += "',b(g),'"; } else if (o',h,") { for (var i",h," = 0; i",h," < o",h,".length; i",h,"++) { data.push(o",h,"[i",h,']); s += "',b(g),'"; data.pop(); }}']).join(""),'; s += "'].join("")}))},d=0,new Function("data",'data = [data], s = "'+b(a.replace(/"/g,'\\"').replace(/\n/g,"\\n"))+'"; return s;')},a.Core.Scaffold={scaffold:function(){var a,b,c;return this.parent={},null!=(null!=(a=this.attributes)?a.parent:void 0)&&(this.parent=this.attributes.parent,delete this.attributes.parent),this.container=this.attributes.container||this.parent.el||document.body,null!=(null!=(b=this.attributes)?b.container:void 0)&&delete this.attributes.container,null!=(null!=(c=this.attributes)?c.entity:void 0)?(this.entity=this.attributes.entity,delete this.attributes.entity):void 0}},a.Url=function(){var b,c,d,e,f,g,i,j,k;return k={attributes:/:([\w\d]+)/g,splat:/\*([\w\d]+)/g,escape:/[-[\]{}()+?.,\\^$|#\s]/g,hash:/^#*/},i={path:null,forward:!0,absolute:!1,routes:{}},j=function(){var a,b,e;return a=1<=arguments.length?h.call(arguments,0):[],a.length>0?(i.forward=!0,b="/"+a.join("/"),b!==i.path?(i.absolute||(b="#"+b),e=window.history.state||null,window.history.pushState(e,document.title,b.toLowerCase()),g()):void 0):i.absolute?d():c()},b=function(){var a;return i.forward=!1,a=null!=window.history.state.steps?window.history.state.steps:1,window.history.go(-a)},e=function(a,b){var c,d;for(c=["url"],k.attributes.lastIndex=0;null!==(d=k.attributes.exec(a));)c.push(d[1]);for(k.splat.lastIndex=0;null!==(d=k.splat.exec(a));)c.push(d[1]);return a=a.replace(k.escape,"\\$&").replace(k.attributes,"([^/]*)").replace(k.splat,"(.*?)"),i.routes[a]={attributes:c,callback:b,regexp:new RegExp("^"+a+"$")}},g=function(a){var b;return a&&a.preventDefault(),b=i.absolute?d():c(),b!==i.path?(i.path=b,f(b)):void 0},d=function(){var a;return a=window.location.pathname,"/"!==a.substr(0,1)&&(a="/#{path}"),a},c=function(){return window.location.hash.replace(k.hash,"")},f=function(a){var b,c,d,e,f,g,h,j,k,l,m;m=[];for(e in i.routes){if(g=i.routes[e],c=g.regexp.exec(a)){for(f={},k=g.attributes,d=h=0,j=k.length;j>h;d=++h)b=k[d],f[b]=c[d];null!=(l=g.callback)&&l.call(this,f);break}m.push(void 0)}return m},function(){return a.$(window).on("popstate",g)}(),{path:j,back:b,listen:e,options:i}}(a),b={touch:"click",doubleTap:"dblClick"},a.Class.Atom=function(c){function d(b){var c,e,f;this.attributes=b,this.bindEntityDestroy=k(this.bindEntityDestroy,this),this.bindEntityUpdate=k(this.bindEntityUpdate,this),d.__super__.constructor.apply(this,arguments),this.attributes=a.Core.Helper.mix(this.attributes,this.constructor["default"]),this.scaffold(),this.entity&&(b=("function"==typeof(f=this.entity).parse?f.parse():void 0)||this.entity.attributes(),this.attributes=a.Core.Helper.mix(this.attributes,b),e=this.entity.className.toClassObject(__.Entity),e&&(c=a.Core.Constants.ENTITY.EVENT,this.attributes.bind.update&&e.bind(c.UPDATE,this.bindEntityUpdate),this.attributes.bind.destroy&&e.bind(c.DESTROY,this.bindEntityDestroy))),this.output(),this.bindEvents()}return j(d,c),d.include(a.Core.Scaffold),d.include(a.Core.Event),d.include(a.Core.Output),d.type="Atom",d["default"]={},d.prototype.bindEntityUpdate=function(a){var b,c,d;if(a.uid===this.entity.uid){c=("function"==typeof(d=this.entity).parse?d.parse():void 0)||this.entity.attributes();for(b in c)this.attributes[b]=c[b];return this.refresh()}},d.prototype.bindEntityDestroy=function(a){return a.uid===this.entity.uid?this.destroy():void 0},d.prototype.bindEvents=function(){var a,c,d,e,f,g;if(this.attributes.events){for(f=this.attributes.events,g=[],d=0,e=f.length;e>d;d++)a=f[d],("undefined"==typeof $$||null===$$)&&(c=b[a]),g.push(this.el.on(c||a,function(a){return function(b){return function(c){return a.el[0].disabled!==!0?a.bubble(b,c):void 0}}}(this)(a)));return g}},d}(a.Core.Module),a.Class.Entity=function(b){function c(a){c.__super__.constructor.apply(this,arguments),this.constructor.constructor.type="Entity",this.constructor.constructor.base=this.constructor.name,this.className=this.constructor.name,a&&this.load(a)}return j(c,b),c.extend(a.Core.Event),c.records={},c.attributes=[],c.fields=function(){var a;return a=1<=arguments.length?h.call(arguments,0):[],this.records={},this.attributes=a||[],this.unbind(),this},c.create=function(a){var b;return b=new this(a),b.save()},c.exists=function(a){return this.find(a)},c.find=function(a){var b;return b=this.records[a],(null!=b?b.clone():void 0)||null},c.findBy=function(a,b){var c,d,e;e=this.records;for(d in e)if(c=e[d],c[a]===b)return c.clone();return null},c.select=function(a){var b,c;return this.cloneArray(function(){var d,e;d=this.records,e=[];for(c in d)b=d[c],a(b)&&e.push(b);return e}.call(this))},c.each=function(a){var b,c,d,e;d=this.records,e=[];for(b in d)c=d[b],e.push(a(c.clone()));return e},c.all=function(){return this.cloneArray(this.recordsValues())},c.count=function(){return this.recordsValues().length},c.cloneArray=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.clone());return e},c.recordsValues=function(){var a,b,c,d;b=[],d=this.records;for(a in d)c=d[a],b.push(c);return b},c.destroyAll=function(){var a,b,c;c=this.records;for(b in c)a=c[b],a.destroy();return this.records={}},c.prototype.isNew=function(){return!this.exists()},c.prototype.exists=function(){return this.uid&&this.uid in this.constructor.records},c.prototype.load=function(a){var b,c;for(b in a)c=a[b],"function"==typeof this[b]?this[b](c):this[b]=c;return this},c.prototype.attributes=function(){var a,b,c,d,e;for(b={},e=this.constructor.attributes,c=0,d=e.length;d>c;c++)a=e[c],a in this&&(b[a]="function"==typeof this[a]?this[a]():this[a]);return b},c.prototype.equal=function(a){return!((null!=a?a.constructor:void 0)!==this.constructor||a.uid!==this.uid)
},c.prototype.save=function(){var a,b;return null!=this.validate&&(a=this.validate()),a?this.trigger("error",a):(b=this.isNew()?this.create():this.update(),this.trigger("save"),b)},c.prototype.updateAttributes=function(a){return this.load(a),this.save()},c.prototype.create=function(){var a;return a=new this.constructor(this.attributes()),a.uid=this.uid,this.constructor.records[this.uid]=a,this.trigger("create"),this.trigger("change"),a.clone()},c.prototype.update=function(){var a;return a=this.constructor.records,a[this.uid].load(this.attributes()),this.trigger("update"),this.trigger("change"),a[this.uid].clone()},c.prototype.destroy=function(){return delete this.constructor.records[this.uid],this.trigger("destroy"),this.trigger("change"),this.unbind()},c.prototype.clone=function(){return Object.create(this)},c.prototype.unbind=function(){return this.trigger("unbind")},c.prototype.trigger=function(){var a,b;return a=1<=arguments.length?h.call(arguments,0):[],a.splice(1,0,this),(b=this.constructor).trigger.apply(b,a)},c}(a.Core.Module),"function"!=typeof Object.create&&(Object.create=function(a){var b;return b=function(){},b.prototype=a,new b}),a.Class.Molecule=function(b){function c(a){var b;this.attributes=a,this._addAtomEntity=k(this._addAtomEntity,this),c.__super__.constructor.apply(this,arguments),this.children=[],this._records=[],this.scaffold(),this.output(),this.chemistry(),null!=(null!=(b=this.attributes.bind)?b.entity:void 0)&&null!=this.attributes.bind.atom&&this.attributes.bind.create&&this._bindEntityCreate()}return j(c,b),c.include(a.Core.Scaffold),c.include(a.Core.Children),c.include(a.Core.Event),c.include(a.Core.Output),c.type="Molecule",c.prototype.entity=function(a,b){var c,d,e,f,g;if(null==b&&(b=!1),b||this.destroyChildren(),null!=(null!=(f=this.attributes.bind)?f.entity:void 0)&&null!=this.attributes.bind.atom){for(g=[],d=0,e=a.length;e>d;d++)c=a[d],g.push(this._addAtomEntity(c,this.attributes.bind));return g}},c.prototype.destroyChildren=function(){var a,b,c,d;for(d=this.children||[],b=0,c=d.length;c>b;b++)a=d[b],"function"==typeof a.destroy&&a.destroy();return this.children=[],this._records=[]},c.prototype._addAtomEntity=function(b,c,d){var e,f,g,h,i,j,k;for(null==d&&(d=!0),f={entity:b,bind:{update:c.update,destroy:c.destroy}},j=["events","callbacks"],h=0,i=j.length;i>h;h++)g=j[h],null!=this.attributes.bind[g]&&(f[g]=this.attributes.bind[g]);return f=a.Core.Helper.mix(f,null!=(k=this["default"].children)?k[this.attributes.entityAtom]:void 0),e=this.appendChild(""+this.attributes.bind.atom,f),d&&this._records.push(e),e},c.prototype._bindEntityCreate=function(){var b;return b=this.attributes.bind.entity.toClassObject(),null!=b?(new b,b.bind(a.Core.Constants.ENTITY.EVENT.CREATE,function(a){return function(b){return a._addAtomEntity(b,a.attributes.bind)}}(this))):void 0},c}(a.Core.Module),a.Class.Organism=function(b){function c(b,e){this.attributes=b,c.__super__.constructor.apply(this,arguments),this.children=[],e&&(d=this._getScaffold(e)),this.attributes=a.Core.Helper.mix(this.attributes,d),d=void 0}var d;return j(c,b),c.include(a.Core.Scaffold),c.include(a.Core.Children),c.include(a.Core.Event),c.include(a.Core.Output),c.type="Organism",d=void 0,c.scaffold=function(a){var b,c;return b="undefined"!=typeof $$&&null!==$$?$$:$,c=b.ajax({url:a,async:!1,dataType:"text",error:function(){throw"Error loading scaffold in "+a}}),d=JSON.parse(c.responseText)},c.prototype.render=function(){return this.scaffold(),this.output(),this.chemistry()},c.prototype._getScaffold=function(a){var b,c;return b="undefined"!=typeof $$&&null!==$$?$$:$,c=b.ajax({url:a,async:!1,dataType:"text",error:function(){throw"Error loading scaffold in "+a}}),d=JSON.parse(c.responseText)},c}(a.Core.Module)}).call(this),function(){var __Media,__path,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;window.__=Atoms.App={version:"0.06.29",Article:{},Aside:{},Modal:{},Entity:{},Extension:{},Url:null},Atoms.$(function(){return navigator.standalone?Atoms.$(document.body).addClass("standalone"):void 0}),Atoms.App.Url=function(a){var _activeSection,_addStepHistory,_article,_aside,_onChangeRoute,_options,_stepHistory;return _article=void 0,_aside=void 0,_options=Atoms.Url.options,_onChangeRoute=function(properties){var article;return article=a.App.Article[properties.article.toClassName()],article?(article.el||article.render(),setTimeout(function(){return _options.forward||_stepHistory(0),_activeSection(article,properties.section),_article!==article?(_options.forward?(_stepHistory(1),article.state("in"),_article&&_article.state("back-in").addClass(article.attributes.style)):(_article.state("out"),article.state("back-out").removeClass(_article.attributes.style)),_article=article):(null!=_article?_article.el.hasClass("aside"):void 0)?_article.aside(_aside):void 0},10)):void 0},_aside=function(id){return null==id&&(id=_aside),null!=_article?_article.aside(_aside=id):void 0},_activeSection=function(article,section){return _addStepHistory(),article.section(section)},_addStepHistory=function(){var state;return state=window.history.state||{steps:0},state.steps++,window.history.replaceState(state,document.title)},_stepHistory=function(value){return window.history.replaceState({steps:value},document.title)},Atoms.$(function(){var url;return url=Atoms.Url.path().split("/"),3===url.length&&_onChangeRoute({article:url[1],section:url[2]}),Atoms.Url.listen("/:article/:section",_onChangeRoute)}),{aside:_aside}}(Atoms),Atoms.Atom.Button=function(_super){function Button(){return Button.__super__.constructor.apply(this,arguments)}return __extends(Button,_super),Button.template='<button class="{{style}}{{^if.text}} icon{{/if.text}}" {{#if.disabled}}disabled{{/if.disabled}}>\n  {{#if.icon}}<span class="icon {{icon}}"></span>{{/if.icon}}\n  {{#if.text}}<abbr>{{text}}</abbr>{{/if.text}}\n  {{#if.count}}<small>{{count}}</small>{{/if.count}}\n</button>',Button.base="Button",Button.events=["touch"],Button["default"]={events:["touch"]},Button}(Atoms.Class.Atom),Atoms.Atom.Figure=function(_super){function Figure(){return Figure.__super__.constructor.apply(this,arguments)}return __extends(Figure,_super),Figure.template='<figure {{#if.style}}class="{{style}}"{{/if.style}}>\n  {{#if.url}}<span class="icon loading-d"></span>{{/if.url}}\n</figure>',Figure.base="Figure",Figure.events=["touch","tap","hold","swipe","rotate"],Figure.prototype._render=function(){var image;return Figure.__super__._render.apply(this,arguments),this.attributes.url?(image=new Image,image.addEventListener("load",function(_this){return function(){return _this.el.html(""),_this.el.attr("style","background-image: url("+_this.attributes.url+");")}}(this)),image.src=this.attributes.url):void 0},Figure}(Atoms.Class.Atom),Atoms.Atom.Heading=function(_super){function Heading(){return Heading.__super__.constructor.apply(this,arguments)}return __extends(Heading,_super),Heading.template='<{{size}} {{#if.style}}class="{{style}}"{{/if.style}}>\n  {{#if.image}}<img src="image" />{{/if.image}}\n  {{#if.value}}{{value}}{{/if.value}}\n</{{size}}>',Heading.base="Heading",Heading["default"]={size:"h1"},Heading}(Atoms.Class.Atom),Atoms.Atom.Icon=function(_super){function Icon(){return Icon.__super__.constructor.apply(this,arguments)}return __extends(Icon,_super),Icon.template='<span class="icon {{#if.icon}}{{icon}}{{/if.icon}} {{#if.style}}{{style}}{{/if.style}}"></span>',Icon.base="Icon",Icon}(Atoms.Class.Atom),Atoms.Atom.Iframe=function(_super){function Iframe(){return Iframe.__super__.constructor.apply(this,arguments)}return __extends(Iframe,_super),Iframe.template='<iframe {{#if.url}}src="{{url}}"{{/if.url}} {{#if.style}}class="{{style}}"{{/if.style}}></iframe>',Iframe.base="Iframe",Iframe}(Atoms.Class.Atom),Atoms.Atom.Image=function(_super){function Image(){return Image.__super__.constructor.apply(this,arguments)}return __extends(Image,_super),Image.template='<img src="{{url}}" {{#if.style}}class="{{style}}"{{/if.style}} {{#if.alt}}alt="{{alt}}"{{/if.alt}}/>',Image.base="Image",Image.events=["touch","tap","hold","swipe","rotate"],Image}(Atoms.Class.Atom),Atoms.Atom.Input=function(_super){function Input(){return Input.__super__.constructor.apply(this,arguments)}return __extends(Input,_super),Input.template='<input type="{{type}}" name="{{name}}" {{#if.placeholder}}placeholder="{{placeholder}}"{{/if.placeholder}} {{#if.style}}class="{{style}}"{{/if.style}} {{#if.value}}value="{{value}}"{{/if.value}} {{#required}}required{{/required}} {{#disabled}}disabled{{/disabled}} {{#if.maxlength}}maxlength={{maxlength}}{{/if.maxlength}} />',Input.base="Input",Input.events=["keypress","keyup","change"],Input["default"]={type:"text"},Input.prototype.value=function(value){return null!=value?this.el.val(value):this.el.val()},Input.prototype.error=function(value,focus){var method;return null==focus&&(focus=!0),method="removeClass",value&&(method="addClass",focus&&this.el[0].focus()),this.el[method]("error")},Input}(Atoms.Class.Atom),Atoms.Atom.AutoComplete=function(_super){function AutoComplete(){this._hide=__bind(this._hide,this),this._bindTouch=__bind(this._bindTouch,this),this._bindKeyup=__bind(this._bindKeyup,this),AutoComplete.__super__.constructor.apply(this,arguments),this.datalist=this.el.find("datalist"),this.el=this.el.find("input"),this.el.bind("keyup",this._bindKeyup),this.datalist.bind("touchstart",this._bindTouch)}return __extends(AutoComplete,_super),AutoComplete["extends"]=!0,AutoComplete.template='<fieldset>\n  <input type="text" name="{{name}}" {{#if.placeholder}}placeholder="{{placeholder}}"{{/if.placeholder}} {{#if.style}}class="{{style}}"{{/if.style}} {{#if.value}}value="{{value}}"{{/if.value}} {{#required}}required{{/required}} {{#disabled}}disabled{{/disabled}} {{#if.maxlength}}maxlength={{maxlength}}{{/if.maxlength}} />\n  <datalist for="{{name}}"></datalist>\n</fieldset>',AutoComplete.events=["change","select"],AutoComplete.prototype.value=function(value){var option,_i,_len,_ref;if(null!=value)return this.el.val(value);for(value=this.el.val(),_ref=this.attributes.options||[],_i=0,_len=_ref.length;_len>_i;_i++)if(option=_ref[_i],option.label===value){value=option.value;break}return value},AutoComplete.prototype._render=function(){var option,options,_i,_len,_ref,_ref1;if((null!=(_ref=this.attributes.options)?_ref.length:void 0)>0){for(options=[],_ref1=this.attributes.options||[],_i=0,_len=_ref1.length;_len>_i;_i++)option=_ref1[_i],options.push(null!=option.value?option:{value:option,label:option});this.attributes.options=options}return AutoComplete.__super__._render.apply(this,arguments)},AutoComplete.prototype._bindKeyup=function(){var markup,option,value,_i,_len,_ref,_ref1;if(this.datalist.removeClass("active"),value=this.el.val().toLowerCase(),null!=this.timer&&clearTimeout(this.timer),value){for(markup="",_ref=this.attributes.options,_i=0,_len=_ref.length;_len>_i;_i++)option=_ref[_i],0===(null!=(_ref1=option.label.toLowerCase().match(value))?_ref1.index:void 0)&&(markup+='<li value="'+option.value+'">'+option.label+"</li>");""!==markup&&(this.datalist.html(markup),this.datalist.addClass("active"),this.timer=setTimeout(function(_this){return function(){return _this._hide()}}(this),3e3))}return __indexOf.call(this.attributes.events||[],"change")>=0?this.bubble("change"):void 0},AutoComplete.prototype._bindTouch=function(event){return this.value(Atoms.$(event.target).html()),this._hide(),__indexOf.call(this.attributes.events||[],"select")>=0?this.bubble("select"):void 0},AutoComplete.prototype._hide=function(){return this.datalist.hasClass("active")?this.datalist.removeClass("active"):void 0},AutoComplete}(Atoms.Atom.Input),Atoms.Atom.Label=function(_super){function Label(){return Label.__super__.constructor.apply(this,arguments)}return __extends(Label,_super),Label.template='<label {{#if.style}}class="{{style}}"{{/if.style}}>\n  {{#if.icon}}<span class="icon {{icon}}"></span>{{/if.icon}}\n  {{value}}\n  {{#if.count}}<strong>{{count}}</strong>{{/if.count}}\n</label>',Label.base="Label",Label}(Atoms.Class.Atom),Atoms.Atom.Li=function(_super){function Li(){return Li.__super__.constructor.apply(this,arguments)}return __extends(Li,_super),Li.template='<li {{#if.style}}class="{{style}}"{{/if.style}}>\n  {{#if.image}}<figure><span class="icon loading-d"></span></figure>{{/if.image}}\n  <div>\n    {{#if.info}}<span>{{info}}</span>{{/if.info}}\n    {{#if.text}}<strong>{{text}}</strong>{{/if.text}}\n    {{#if.description}}<small>{{description}}</small>{{/if.description}}\n  </div>\n</li>',Li.base="Li",Li.events=["touch","doubleTap","hold","swipeLeft","swipeRight"],Li.prototype._render=function(){var figure,image;return Li.__super__._render.apply(this,arguments),this.attributes.image?(figure=this.el.children("figure"),image=new Image,image.addEventListener("load",function(_this){return function(){return figure.html(""),figure.attr("style","background-image: url("+_this.attributes.image+");")}}(this)),image.src=this.attributes.image):void 0},Li}(Atoms.Class.Atom),Atoms.Atom.Link=function(_super){function Link(){return Link.__super__.constructor.apply(this,arguments)}return __extends(Link,_super),Link.template='<a href="{{href}}" {{#if.target}}target="{{target}}"{{/if.target}} {{#if.style}}class="{{style}}"{{/if.style}} >\n  {{#if.icon}}<span class="icon {{icon}}"></span>{{/if.icon}}\n  {{#if.text}}{{text}}{{/if.text}}\n  {{#if.info}}<small>{{info}}</small>{{/if.info}}\n</a>',Link.base="Link",Link}(Atoms.Class.Atom),__Media=function(_super){function __Media(){var event,events,_i,_len,_ref;for(__Media.__super__.constructor.apply(this,arguments),events={load:"canplaythrough",downloading:"progress",timing:"timeupdate",end:"ended"},_ref=this.attributes.events||[],_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],event in events&&this._listen(events[event],event)}return __extends(__Media,_super),__Media.events=["load","error","downloading","play","timing","pause","stop","end"],__Media.prototype.src=function(url,type){return url?(this.el.attr("src",url),type&&this.el.attr("type",type),this.el[0].load()):this.el.attr("src")},__Media.prototype.play=function(){return this.el[0].play()},__Media.prototype.stop=function(){return this.time(0),this.pause()},__Media.prototype.pause=function(){return this.el[0].pause()},__Media.prototype.volume=function(percent){return null!=percent?this.el[0].volume=parseInt(percent)/100:this.el[0].volume},__Media.prototype.time=function(value){return null!=value?this.el[0].currentTime=value:this.el[0].currentTime},__Media.prototype.duration=function(){return this.el[0].duration},__Media.prototype._listen=function(event,bubble){return this.el.bind(event,function(_this){return function(event){return _this.bubble(bubble,event)}}(this))},__Media}(Atoms.Class.Atom),Atoms.Atom.Audio=function(_super){function Audio(){return Audio.__super__.constructor.apply(this,arguments)}return __extends(Audio,_super),Audio.template='<audio {{#if.autoplay}}autoplay="{{autoplay}}"{{/if.autoplay}} {{#if.controls}}controls="{{controls}}"{{/if.controls}} {{#if.preload}}preload="{{preload}}"{{/if.preload}} {{#if.loop}}loop="{{loop}}"{{/if.loop}} {{#if.src}}src="{{src}}"{{/if.src}}></audio>',Audio.base="Audio",Audio.prototype.src=function(url,type){return null==type&&(type="audio/mpeg"),Audio.__super__.src.call(this,url,type)},Audio}(__Media),Atoms.Atom.Video=function(_super){function Video(){return Video.__super__.constructor.apply(this,arguments)}return __extends(Video,_super),Video.template='<video {{#if.autoplay}}autoplay="{{autoplay}}"{{/if.autoplay}} {{#if.controls}}controls="{{controls}}"{{/if.controls}} {{#if.preload}}preload="{{preload}}"{{/if.preload}} {{#if.loop}}loop="{{loop}}"{{/if.loop}} {{#if.src}}src="{{src}}"{{/if.src}}></video>',Video.base="Video",Video.prototype.src=function(url,type){return null==type&&(type="audio/mpeg"),Video.__super__.src.call(this,url,type)},Video}(__Media),Atoms.Atom.Progress=function(_super){function Progress(){return Progress.__super__.constructor.apply(this,arguments)}return __extends(Progress,_super),Progress.template='<progress {{#if.style}}class="{{style}}"{{/if.style}} {{#if.max}}max="{{max}}"{{/if.max}} {{#if.value}}value="{{value}}"{{/if.value}}></progress>',Progress.base="Progress",Progress["default"]={max:100,value:0},Progress.prototype.value=function(value){return value?this.el[0].value=value:this.el[0].value},Progress}(Atoms.Class.Atom),Atoms.Atom.Select=function(_super){function Select(){Select.__super__.constructor.apply(this,arguments),null!=this.attributes.value&&this.value(this.attributes.value)}return __extends(Select,_super),Select.template='<select name="{{name}}" {{#if.style}}class="{{style}}"{{/if.style}} {{#required}}required{{/required}} {{#disabled}}disabled{{/disabled}}>\n  {{#options}}\n    <option value="{{value}}">{{label}}</option>\n  {{/options}}\n</select>',Select.base="Select",Select.events=["change"],Select.prototype._render=function(){var option,options,_i,_len,_ref,_ref1;if((null!=(_ref=this.attributes.options)?_ref.length:void 0)>0){for(options=[],_ref1=this.attributes.options,_i=0,_len=_ref1.length;_len>_i;_i++)option=_ref1[_i],options.push(null!=option.value?option:{value:option,label:option});this.attributes.options=options}return Select.__super__._render.apply(this,arguments)},Select.prototype.value=function(value){return null!=value?this.el.val(value):this.el.val()},Select}(Atoms.Class.Atom),Atoms.Atom.Switch=function(_super){function Switch(){this.onTap=__bind(this.onTap,this);var event_name;Switch.__super__.constructor.apply(this,arguments),null!=this.attributes.value&&this.value(this.attributes.value),event_name=("undefined"!=typeof $$&&null!==$$&&"function"==typeof $$.isMobile?$$.isMobile():void 0)?"touchstart":"change",this.el.bind(event_name,this.onTap)}return __extends(Switch,_super),Switch.template='<input type="checkbox" name="{{name}}" {{#if.style}}class="{{style}}"{{/if.style}} {{#required}}required{{/required}} {{#disabled}}disabled{{/disabled}} />',Switch.base="Switch",Switch.events=["changed"],Switch.prototype.value=function(value){return value===!0?this.el.attr("checked","true"):value===!1?this.el.removeAttr("checked"):null!=this.el.attr("checked")},Switch.prototype.onTap=function(event){return event.preventDefault(),this.value(!this.el.attr("checked")),this.bubble("changed",event)},Switch}(Atoms.Class.Atom),Atoms.Atom.Text=function(_super){function Text(){return Text.__super__.constructor.apply(this,arguments)}return __extends(Text,_super),Text.template='<p {{#if.style}}class="{{style}}"{{/if.style}}>{{value}}</p>',Text.base="Text",Text}(Atoms.Class.Atom),Atoms.Atom.Textarea=function(_super){function Textarea(){return Textarea.__super__.constructor.apply(this,arguments)}return __extends(Textarea,_super),Textarea.template='<textarea name="{{name}}" {{#if.placeholder}}placeholder="{{placeholder}}"{{/if.placeholder}} {{#if.style}}class="{{style}}"{{/if.style}} {{#required}}required{{/required}} {{#disabled}}disabled{{/disabled}}>{{#if.value}}{{value}}{{/if.value}}</textarea>',Textarea.base="Textarea",Textarea.events=["keypress","keyup","change"],Textarea.prototype.value=function(value){return null!=value?this.el.val(value):this.el.val()},Textarea}(Atoms.Class.Atom),Atoms.Molecule.Div=function(_super){function Div(){return Div.__super__.constructor.apply(this,arguments)}return __extends(Div,_super),Div.template='<div {{#if.style}}class="{{style}}"{{/if.style}}></div>',Div.base="Div",Div.events=["touch"],Div}(Atoms.Class.Molecule),Atoms.Molecule.Form=function(_super){function Form(){this.onButtonTouch=__bind(this.onButtonTouch,this),this.onSwitchChanged=__bind(this.onSwitchChanged,this),this.onSelectChange=__bind(this.onSelectChange,this),this.onInputKeyup=__bind(this.onInputKeyup,this),this.onInputKeypress=__bind(this.onInputKeypress,this),Form.__super__.constructor.apply(this,arguments),this.el.bind("submit",function(event){return event.preventDefault()})}return __extends(Form,_super),Form.template='<form {{#if.style}}class="{{style}}"{{/if.style}}></form>',Form.available=["Atom.Button","Atom.Input","Atom.Label","Atom.Progress","Atom.Select","Atom.Switch","Atom.Textarea"],Form.events=["change","submit","error"],Form.base="Form",Form["default"]={events:["submit"]},Form.prototype.value=function(){var child,properties,_i,_len,_ref;for(properties={},_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],child.attributes.name&&null!=child.value&&(properties[child.attributes.name.toLowerCase()]=child.value());return properties},Form.prototype.clean=function(){var child,_i,_len,_ref;for(_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],child.attributes.name&&null!=child.value&&child.value("");return!0},Form.prototype.onInputKeypress=function(event,atom){return this._bubbleChange(event,atom)},Form.prototype.onInputKeyup=function(event,atom){return this._bubbleChange(event,atom)},Form.prototype.onInputChange=function(event,atom){return this._bubbleChange(event,atom)},Form.prototype.onSelectChange=function(event,atom){return this._bubbleChange(event,atom)},Form.prototype.onSwitchChanged=function(event,atom){return this._bubbleChange(event,atom)},Form.prototype.onButtonTouch=function(event){var child,method,required,_i,_len,_ref;for(event.preventDefault(),required=!0,_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],null!=child.value&&(child.attributes.required&&!child.value()?(child.el.addClass("error"),required=!1):child.el.removeClass("error"));return method=required?"submit":"error",this.bubble(method,event),!1},Form.prototype._bubbleChange=function(event,atom){return event.preventDefault(),atom.attributes.required&&!atom.value()?atom.el.addClass("error"):atom.el.removeClass("error"),this.bubble("change",event),!1},Form}(Atoms.Class.Molecule),Atoms.Molecule.List=function(_super){function List(){return this.onLiTouch=__bind(this.onLiTouch,this),this.select=__bind(this.select,this),this.findBy=__bind(this.findBy,this),List.__super__.constructor.apply(this,arguments)}return __extends(List,_super),List.template='<ul {{#if.style}}class="{{style}}"{{/if.style}}></ul>',List.available=["Atom.Li"],List.base="List",List.events=["select"],List.prototype.findBy=function(field,value){return this.select(function(entity){var _ref;return(null!=(_ref=entity[field])?_ref.toLowerCase().trim():void 0)===value.toLowerCase().trim()?entity:void 0})},List.prototype.select=function(callback){var record,records,_i,_len,_ref,_results;for(this.clean(),this.children=[],callback&&(records=function(){var _i,_len,_ref,_results;for(_ref=this._records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],callback(record.entity)&&_results.push(record);return _results}.call(this)),_ref=records||this._records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],_results.push(this._addAtomEntity(record.entity,this.attributes.bind,record=!1));return _results},List.prototype.all=function(){return this.select()},List.prototype.clean=function(){return this.el.html("")},List.prototype.onLiTouch=function(event,atom){return __indexOf.call(this.attributes.events||[],"select")>=0?this._bubbleSelect(event,atom):void 0},List.prototype._bubbleSelect=function(event,atom){return event.preventDefault(),this.bubble("select",atom),!1},List}(Atoms.Class.Molecule),Atoms.Molecule.Navigation=function(_super){function Navigation(){return Navigation.__super__.constructor.apply(this,arguments)}return __extends(Navigation,_super),Navigation.template='<nav {{#if.style}}class="{{style}}"{{/if.style}}></nav>',Navigation.available=["Atom.Button","Atom.Link"],Navigation.base="Navigation",Navigation.events=["select"],Navigation.prototype.onButtonTouch=function(event,atom){return this._bubbleSelect(event,atom)},Navigation.prototype.onLinkTouch=function(event,atom){return this._bubbleSelect(event,atom)},Navigation.prototype.onArticleChange=function(){var article,child,event,hierarchy,path,_i,_len,_ref;for(event=arguments[0],article=arguments[1],hierarchy=3<=arguments.length?__slice.call(arguments,2):[],path=Atoms.Url.path().substr(1),_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++)if(child=_ref[_i],child.attributes.path===path){this._active(child);break}return!1},Navigation.prototype.onSectionScroll=function(event){return this.el[event.addClass?"addClass":"removeClass"]("scroll"),!1},Navigation.prototype._active=function(atom){return atom.el.addClass("active").siblings().removeClass("active")},Navigation.prototype._bubbleSelect=function(event,atom){var _ref;return event.preventDefault(),!(null!=(_ref=atom.attributes.callbacks)?_ref.length:void 0)>0?(this.bubble("select",event,atom),null!=atom.attributes.path&&__path(atom.attributes.path),!1):void 0},Navigation}(Atoms.Class.Molecule),__path=function(path){var parts;return null!=path&&(parts=path.split("/"),1===parts.length?"back"===parts[0]?Atoms.Url.back():Atoms.App.Url.aside(parts[0]):Atoms.Url.path()==="/"+path?Atoms.App.Url.aside():2===parts.length&&Atoms.Url.path(path)),!1},Atoms.Molecule.Search=function(_super){function Search(){return this.onButtonTouch=__bind(this.onButtonTouch,this),this.onInputKeypress=__bind(this.onInputKeypress,this),this.onInputKeyup=__bind(this.onInputKeyup,this),Search.__super__.constructor.apply(this,arguments)}return __extends(Search,_super),Search.available=["Atom.Input","Atom.Button"],Search.events=["change","submit"],Search["extends"]=!0,Search["default"]={events:["submit"],children:[{"Atom.Input":{id:"input",type:"search",placeholder:"Type your search...",events:["keypress","keyup"],required:!0}},{"Atom.Button":{icon:"search"}}]},Search.prototype.value=function(value){return this.input.value(value)},Search.prototype.onInputKeyup=function(event){return 13!==event.keyCode&&this.bubble("change",event),!1},Search.prototype.onInputKeypress=function(event,atom){return 13===event.keyCode&&this._bubbleSubmit(event,atom),!1},Search.prototype.onButtonTouch=function(event,atom){return event.preventDefault(),this._bubbleSubmit(event,atom),!1},Search.prototype.onSectionScroll=function(event){return this.el[event.addClass?"addClass":"removeClass"]("scroll"),!1},Search.prototype._bubbleSubmit=function(event,atom){var value;return atom.el.blur(),value=this.input.value(),""!==value?this.bubble("submit",event):void 0},Search}(Atoms.Molecule.Form),Atoms.Molecule.Tags=function(_super){function Tags(){return this.onLabelTap=__bind(this.onLabelTap,this),this.onLabelSingleTap=__bind(this.onLabelSingleTap,this),Tags.__super__.constructor.apply(this,arguments)}return __extends(Tags,_super),Tags["extends"]=!0,Tags.available=["Atom.Label"],Tags.events=["select"],Tags.prototype.onLabelSingleTap=function(event,atom){return this._bubbleSelect(event,atom)},Tags.prototype.onLabelTap=function(event,atom){return this._bubbleSelect(event,atom)},Tags.prototype._bubbleSelect=function(event,atom){return event.preventDefault(),this.bubble("select",atom),!1},Tags}(Atoms.Molecule.Div),Atoms.Organism.Article=function(_super){function Article(attributes,scaffold){null==attributes&&(attributes={}),this.onAnimationEnd=__bind(this.onAnimationEnd,this),this.aside=__bind(this.aside,this),Article.__super__.constructor.call(this,attributes,scaffold),Atoms.App.Article[this.constructor.name]=this}var ACTIVE_STATES,EVENT;return __extends(Article,_super),Article.template='<article {{#if.id}}id="{{id}}"{{/if.id}} {{#if.style}}class="{{style}}"{{/if.style}}></article>',Article.available=["Organism.Header","Organism.Section","Organism.Footer","Molecule.Navigation","Molecule.Form"],Article.base="Article",Article.events=["show","hide"],ACTIVE_STATES=["in","back-out","aside-show","aside-hide","aside-show-right","aside-hide-right"],EVENT={TUNNEL:{ARTICLE_CHANGE:"onArticleChange",SECTION_SCROLL:"onSectionScroll"}},Article.prototype.render=function(){var animation_end,_i,_len,_ref,_results;for(Article.__super__.render.apply(this,arguments),_ref=Atoms.Core.Constants.ANIMATION.END.split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)animation_end=_ref[_i],_results.push(this.el.bind(animation_end,this.onAnimationEnd));return _results},Article.prototype.state=function(name){return this.el.addClass("active").attr("data-state",name)},Article.prototype.section=function(id){var child,_i,_len,_ref;for(this.tunnel(EVENT.TUNNEL.ARTICLE_CHANGE),this.tunnel(EVENT.TUNNEL.SECTION_SCROLL),_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],"Section"===child.constructor.base&&(child.attributes.id===id?(child.show(),child.el.focus()):child.el.hasClass("active")&&(child.hide(),child.el.blur()));return"aside-show"===this.el.attr("data-state")?this.aside():void 0},Article.prototype.aside=function(id){var aside_instance,method;return aside_instance=Atoms.App.Aside[id.toClassName()],null!=aside_instance?(method=this.el.hasClass("aside")?"hide":"show",aside_instance[method](),"hide"===method&&this.el.removeClass("aside").removeClass("right"),"right"===aside_instance.attributes.style&&(method+="-right"),this.state("aside-"+method),aside_instance.tunnel(EVENT.TUNNEL.ARTICLE_CHANGE)):void 0},Article.prototype.onAnimationEnd=function(){var state;return state=this.el.attr("data-state"),"in"===state||"back-out"===state?this.trigger("show"):("out"===state||"back-in"===state)&&this.trigger("hide"),__indexOf.call(ACTIVE_STATES,state)<0&&this.el.removeClass("active"),("aside-show"===state||"aside-show-right"===state)&&(this.el.addClass("aside"),"aside-show-right"===state&&this.el.addClass("right")),this.el.removeAttr("data-state")},Article.prototype.onSectionScroll=function(event){return event.addClass=event.down&&(event.percent>5||event.height-event.scroll<128)?!0:!1,this.tunnel("onSectionScroll",event),!1},Article}(Atoms.Class.Organism),Atoms.Organism.Aside=function(_super){function Aside(attributes,scaffold){null==attributes&&(attributes={}),this.onAnimationEnd=__bind(this.onAnimationEnd,this),attributes.method="prepend",Aside.__super__.constructor.call(this,attributes,scaffold),Atoms.App.Aside[this.constructor.name]=this}return __extends(Aside,_super),Aside.template='<aside {{#if.id}}id="{{id}}"{{/if.id}} {{#if.style}}class="{{style}}"{{/if.style}}></aside>',Aside.available=["Organism.Header","Organism.Section","Organism.Footer","Molecule.Navigation","Molecule.Form"],Aside.base="Aside",Aside.events=["show","hide"],Aside.prototype.render=function(){var animation_end,_i,_len,_ref,_results;for(Aside.__super__.render.apply(this,arguments),_ref=Atoms.Core.Constants.ANIMATION.END.split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)animation_end=_ref[_i],_results.push(this.el.bind(animation_end,this.onAnimationEnd));return _results},Aside.prototype.show=function(){return this.el||this.render(),this.el.addClass("active"),this.el.attr("data-state","in")},Aside.prototype.hide=function(){var _ref;return(null!=(_ref=this.el)?_ref.hasClass("active"):void 0)?this.el.attr("data-state","out"):void 0},Aside.prototype.onAnimationEnd=function(){var state;return state=this.el.attr("data-state"),this.trigger("in"===state?"show":"hide"),this.el.removeAttr("data-state"),"out"===state?this.el.removeClass("active"):void 0},Aside}(Atoms.Class.Organism),Atoms.Organism.Footer=function(_super){function Footer(){Footer.__super__.constructor.apply(this,arguments),this.render()}return __extends(Footer,_super),Footer.template='<footer {{#if.style}}class="{{style}}"{{/if.style}}></footer>',Footer.available=["Atom.Progress","Molecule.Navigation"],Footer.base="Footer",Footer.prototype.onSectionScroll=function(event){return this.el[event.addClass?"addClass":"removeClass"]("scroll"),!1},Footer
}(Atoms.Class.Organism),Atoms.Organism.Header=function(_super){function Header(){Header.__super__.constructor.apply(this,arguments),this.render()}return __extends(Header,_super),Header.template='<header {{#if.style}}class="{{style}}"{{/if.style}}></header>',Header.available=["Atom.Heading","Atom.Icon","Atom.Image","Atom.Progress","Molecule.Navigation"],Header.base="Header",Header.prototype.onSectionScroll=function(event){return this.el[event.addClass?"addClass":"removeClass"]("scroll"),!1},Header}(Atoms.Class.Organism),Atoms.Organism.Modal=function(_super){function Modal(attributes,scaffold){var animation_end,block_el,_i,_len,_ref;for(null==attributes&&(attributes={}),this.onAnimationEnd=__bind(this.onAnimationEnd,this),Modal.__super__.constructor.call(this,attributes,scaffold),block_el=Atoms.$(document.createElement("div")).attr("data-system","modal"),Atoms.$(this.attributes.container||document.body).prepend(block_el),this.attributes.container=block_el,Atoms.App.Modal[this.constructor.name]=this,this.render(),_ref=Atoms.Core.Constants.ANIMATION.END.split(" "),_i=0,_len=_ref.length;_len>_i;_i++)animation_end=_ref[_i],this.el.bind(animation_end,this.onAnimationEnd)}return __extends(Modal,_super),Modal.template='<article {{#if.id}}id="{{id}}"{{/if.id}} {{#if.style}}class="{{style}}"{{/if.style}}></article>',Modal.available=["Organism.Header","Organism.Section","Organism.Footer"],Modal.base="Modal",Modal.events=["show","hide"],Modal.prototype.show=function(){return this.el.parent().addClass("active"),this.el.addClass("show"),this.trigger("show"),setTimeout(function(_this){return function(){return _this.onAnimationEnd()}}(this),450)},Modal.prototype.hide=function(){return this.el.addClass("hide"),this.trigger("hide")},Modal.prototype.onAnimationEnd=function(){return this.el.hasClass("show")&&this.el.removeClass("show"),this.el.hasClass("hide")?(this.el.removeClass("hide"),this.el.parent().removeClass("active")):void 0},Modal}(Atoms.Class.Organism),Atoms.Organism.Loading=function(_super){function Loading(){return Loading.__super__.constructor.apply(this,arguments)}return __extends(Loading,_super),Loading}(Atoms.Organism.Modal),new Atoms.Organism.Loading,Atoms.Organism.Section=function(_super){function Section(attributes,scaffold){null==attributes&&(attributes={}),this._scrollEvent=__bind(this._scrollEvent,this),Section.__super__.constructor.call(this,attributes,scaffold),this.render()}return __extends(Section,_super),Section.template='<section {{#if.id}}id="{{id}}"{{/if.id}} {{#if.style}}class="{{style}}"{{/if.style}}></section>',Section.available=["Molecule.Div","Molecule.Form","Molecule.List","Molecule.Navigation","Molecule.Tags","Atom.Audio","Atom.Button","Atom.Figure","Atom.GMap","Atom.Heading","Atom.Icon","Atom.Image","Atom.Progress","Atom.Text","Atom.Video"],Section.base="Section",Section.events=["show","hide","scroll","pull"],Section.prototype.render=function(){return Section.__super__.render.apply(this,arguments),__indexOf.call(this.attributes.events||[],"scroll")>=0&&this.bindScroll(),__indexOf.call(this.attributes.events||[],"pull")>=0?this.bindPull():void 0},Section.prototype.show=function(){return this.el.addClass("active"),this.bubble("show")},Section.prototype.hide=function(){return this.el.removeClass("active"),this.bubble("hide")},Section.prototype.refresh=function(){return this.pulling=!1,this.el.removeAttr("data-state=pull").css("top","0px"),setTimeout(function(_this){return function(){return _this.el.removeAttr("style").removeClass("loading").removeClass("with-navigation").removeAttr("data-state")}}(this),450)},Section.prototype.bindScroll=function(){return this.current_scroll=0,this.el.bind("scroll",this._scrollEvent),this.el.bind("touchcancel",this._scrollEvent)},Section.prototype.bindPull=function(){return this.pulling=!1,this.el.bind("touchstart",function(_this){return function(){return _this.el.offset().top>60?_this.el.addClass("with-navigation"):void 0}}(this)),this.el.bind("swiping",function(_this){return function(event){var y;return y=event.quoData.delta.y,_this.el[0].scrollTop<16&&!_this.pulling&&y>0&&(event.originalEvent.preventDefault(),y=event.quoData.delta.y,y>=0&&80>=y&&(_this.el.attr("data-state","pulling").css("top",""+y+"px"),y>72))?(_this.pulling=!0,_this.bubble("pull",event),_this.el.attr("data-state","pull")):void 0}}(this)),this.el.bind("touchend",function(_this){return function(){return _this.el.css("transition","top 300ms"),_this.pulling?_this.el.addClass("loading"):_this.refresh()}}(this))},Section.prototype._scrollEvent=function(event){var down;return down=event.target.scrollTop>this.current_scroll?!0:!1,this.current_scroll=event.target.scrollTop,event={height:parseInt(event.target.scrollHeight-event.target.getBoundingClientRect().height),scroll:event.target.scrollTop,down:down,up:!down},event.percent=parseInt(100*event.scroll/event.height),this.bubble("scroll",event)},Section}(Atoms.Class.Organism)}.call(this),function(){!function(n){var e,t,r,i,u;return t=function(){return this._callbacks=[],this},i=function(n){var e,r,i,u,o,l,s;for(e=n.length,r=0,l=new t,i=[],s=[],o=function(n){return function(t,u){return r+=1,i[n]=t,s[n]=u,r===e?l.done(i,s):void 0}},u=0;e>u;)n[u]().then(o(u)),u++;return l},r=function(n,e,i,u){var o;return o=new t,0===n.length||null!=u&&null!=e?o.done(e,i):n[0](e,i).then(function(e,t){return n.splice(0,1),r(n,e,t,u).then(function(n,e){return o.done(n,e)})}),o},u=function(n,e,t){return r(n,e,t,!0)},t.prototype.then=function(n,e){var t;return t=function(){return n.apply(e,arguments)},this._isdone?t(this.error,this.result):this._callbacks.push(t)},t.prototype.done=function(n,e){var t,r;for(this._isdone=!0,this.error=n,this.result=e,t=0,r=this._callbacks.length;r>t;)this._callbacks[t](n,e),t++;return this._callbacks=[]},e={Promise:t,join:i,chain:r,shield:u},"function"==typeof define&&define.amd?define(function(){return e}):n.Hope=e,"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports=e:void 0}(this)}.call(this),function(){!function(n){var t,e,r,i,u;return e=function(){return this._callbacks=[],this},i=function(n){var t,r,i,u,o,s,l;for(t=n.length,r=0,s=new e,i=[],l=[],o=function(n){return function(e,u){return r+=1,i[n]=e,l[n]=u,r===t?s.done(i,l):void 0}},u=0;t>u;)n[u]().then(o(u)),u++;return s},r=function(n,t,i,u){var o;return o=new e,0===n.length||null!=u&&null!=t?o.done(t,i):n[0](t,i).then(function(t,e){return n.splice(0,1),r(n,t,e,u).then(function(n,t){return o.done(n,t)})}),o},u=function(n,t,e){return r(n,t,e,!0)},e.prototype.then=function(n,t){var e;return e=function(){return n.apply(t,arguments)},this._isdone?e(this.error,this.result):this._callbacks.push(e)},e.prototype.done=function(n,t){var e,r;for(this._isdone=!0,this.error=n,this.result=t,e=0,r=this._callbacks.length;r>e;)this._callbacks[e](n,t),e++;return this._callbacks=[]},t={Promise:e,join:i,chain:r,shield:u},"function"==typeof define&&define.amd?define(function(){return t}):n.Hope=t}(this)}.call(this),function(){var Appnima,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Appnima=Appnima={version:"1.06.16b",key:null,token:null,host:{main:"http://api.appnima.com",socket:"http://socket.appnima.com",rtc:"http://rtc.appnima.com",storage:"http://storage.appnima.com"},Dom:"undefined"!=typeof $$&&null!==$$?$$:$,onError:null},Appnima.Calendar=function(app){var activityCalendar,activityEvent,assistentEvent,create,deleteEvent,event,guestEvent,list,listEvents,remove,searchEvent,shared,update,updateEvent,_url;return list=function(){return app.connect("GET",""+_url(),{})},create=function(parameters){return app.connect("POST",""+_url(),parameters)},update=function(parameters){return app.connect("PUT",""+_url(),parameters)},shared=function(parameters){return app.connect("PUT",""+_url()+"/shared",parameters)},activityCalendar=function(id){var data;return data={id:id},app.connect("GET",""+_url()+"/activity",data)},remove=function(calendar){var data;return data={id:calendar},app.connect("DELETE",""+_url(),data)},event=function(parameters){return app.connect("POST",""+_url()+"/event",parameters)},updateEvent=function(parameters){return app.connect("PUT",""+_url()+"/event",parameters)},listEvents=function(data){return app.connect("GET",""+_url()+"/event",data)},guestEvent=function(data){return app.connect("PUT",""+_url()+"/event/guest",data)},assistentEvent=function(data){return app.connect("PUT",""+_url()+"/event/assistent",data)},searchEvent=function(query){var data;return data={query:query},app.connect("GET",""+_url()+"/event/search",data)},activityEvent=function(id){var data;return data={id:id},app.connect("GET",""+_url()+"/event/activity",data)},deleteEvent=function(event){var data;return data={id:event},app.connect("DELETE",""+_url()+"/event",data)},_url=function(){return app.host.main+"/calendar"},{list:list,create:create,update:update,shared:shared,activityCalendar:activityCalendar,remove:remove,event:event,updateEvent:updateEvent,listEvents:listEvents,guestEvent:guestEvent,assistentEvent:assistentEvent,searchEvent:searchEvent,activityEvent:activityEvent,deleteEvent:deleteEvent}}(Appnima),Appnima.connect=function(type,url,parameters,token,multipart){var attributes,error,headers,promise;null==token&&(token=!1),null==multipart&&(multipart=!1),headers={},token&&null!=Appnima.key&&(headers={Authorization:"basic "+Appnima.key}),!token&&Appnima.key&&(headers={Authorization:"bearer "+Appnima.token}),promise=new Hope.Promise;try{attributes={url:url,type:type,headers:headers,data:parameters,success:function(){return function(response){return response?promise.done(null,response):promise.done("Unknown error",null)}}(this),error:function(_this){return function(type,xhr){var error,response;return"string"!=typeof type&&(xhr=type),response=null!=xhr.response?xhr.response:xhr.responseText,error={code:xhr.status,type:xhr.statusText,message:JSON.parse(response).message},promise.done(error,null),null!=Appnima.onError?Appnima.onError.call(_this,error):void 0}}(this)},multipart===!0?(attributes.processData=!1,attributes.contentType=!1):(attributes.dataType="json",attributes.contentType="application/x-www-form-urlencoded"),this.Dom.ajax(attributes)}catch(_error){error=_error,promise.done(error,null)}return promise},Appnima.connectMultipart=function(type,url,parameters,callbacks){var formData,name,onLoadComplete,promise,value,xhr;null==callbacks&&(callbacks={}),promise=new Hope.Promise,formData=new FormData;for(name in parameters)value=parameters[name],formData.append(name,value);return xhr=new XMLHttpRequest,xhr.responseType="json",onLoadComplete=function(){return promise.done(null,this.response)},xhr.addEventListener("load",onLoadComplete,!1),callbacks.progress&&xhr.upload.addEventListener("progress",callbacks.progress,!1),callbacks.error&&xhr.addEventListener("error",callbacks.error,!1),callbacks.abort&&xhr.addEventListener("abort",callbacks.abort,!1),xhr.open("POST",url),xhr.setRequestHeader("Authorization","bearer "+Appnima.token),xhr.send(formData),promise},Appnima.Location=function(app){var add,checkin,checkins,friends,people,place,places,user,_find,_url;return places=function(latitude,longitude,precision,meters,type){var parameters;return null==meters&&(meters=5e3),null==type&&(type=null),parameters={latitude:latitude,longitude:longitude},null!=precision&&(parameters.precision=precision),null==precision&&(parameters.radius=meters),app.connect("GET",""+_url()+"places",parameters)},place=function(id,reference){var parameters;return parameters={id:id},null!=reference&&(parameters.reference=reference),app.connect("GET",""+_url()+"place",parameters)},add=function(name,address,locality,postal_code,country,latitude,longitude,mail,phone,website){var parameters;return parameters={name:name,address:address,locality:locality,postal_code:postal_code,country:country,latitude:latitude,longitude:longitude},null!=mail&&(parameters.mail=mail),null!=phone&&(parameters.phone=phone),null!=website&&(parameters.website=website),app.connect("POST",""+_url()+"place",parameters)},checkin=function(id){return app.connect("POST",""+_url()+"checkin",{id:id})},checkins=function(user){return app.connect("GET",""+_url()+"checkin",{user:user})},friends=function(latitude,longitude,meters){return null==meters&&(meters=5e3),_find("friends",latitude,longitude,meters)},people=function(latitude,longitude,meters){return null==meters&&(meters=5e3),_find("people",latitude,longitude,meters)},user=function(latitude,longitude){var parameters;return parameters={latitude:null!=latitude?latitude:void 0,longitude:null!=longitude?longitude:void 0},null!=parameters.latitude&&null!=parameters.longitude?app.connect("POST",""+_url()+"user",parameters):app.connect("GET",""+_url()+"user")},_find=function(method,latitude,longitude,meters){var parameters;return null==meters&&(meters=5e3),parameters={latitude:latitude,longitude:longitude,radius:meters},app.connect("GET",""+_url()+method,parameters)},_url=function(){return app.host.main+"/location/"},{places:places,place:place,add:add,checkin:checkin,checkins:checkins,people:people,friends:friends,user:user}}(Appnima),Appnima.Messenger=function(app){var SMS,conversation,deleteMessage,mail,message,messageInbox,messageOutbox,readMessage,search,summary,_messageState,_url;return mail=function(parameters){return app.connect("POST",""+_url()+"mail",parameters)},message=function(parameters){return app.connect("POST",""+_url()+"message",parameters)},SMS=function(parameters){return app.connect("POST",""+_url()+"sms",parameters)},messageInbox=function(){return app.connect("GET",""+_url()+"message/inbox",{})},messageOutbox=function(){return app.connect("GET",""+_url()+"message/outbox",{})},summary=function(){return app.connect("GET",""+_url()+"summary")},search=function(query){var parameters;return parameters={query:query},app.connect("GET",""+_url()+"search",parameters)},conversation=function(username){var parameters;return parameters={username:username},app.connect("GET",""+_url()+"conversation",parameters)},readMessage=function(message){return _messageState(message,"READ")},deleteMessage=function(message){return _messageState(message,"DELETED")},_messageState=function(message,state){var parameters;return parameters={message:message,state:state},app.connect("PUT",""+_url()+"message",parameters)},_url=function(){return app.host.main+"/messenger/"},{mail:mail,SMS:SMS,message:message,readMessage:readMessage,deleteMessage:deleteMessage,messageInbox:messageInbox,messageOutbox:messageOutbox,summary:summary,conversation:conversation,search:search}}(Appnima),Appnima.Network=function(app){var check,follow,followers,following,friends,search,shieldFollow,unfollow,_errorParameters,_relationship,_url;return following=function(parameters){return app.connect("GET",""+_url()+"following",parameters)},followers=function(parameters){return app.connect("GET",""+_url()+"followers",parameters)},friends=function(user){var parameters;return parameters=null!=user?{user:user}:void 0,app.connect("GET",""+_url()+"friends",parameters)},follow=function(user_id){return _relationship("POST","follow",user_id)},shieldFollow=function(user_id){var parameters;return parameters={},parameters.user=user_id,parameters.shield=!0,app.connect("POST",""+_url()+"follow",parameters)},check=function(user_id){return _relationship("GET","check",user_id)},unfollow=function(user_id){return _relationship("POST","unfollow",user_id)},search=function(query){return app.connect("GET",""+_url()+"search",{query:query})},_relationship=function(type,method,user_id){var promise;return promise=new Hope.Promise,user_id?app.connect(type,""+_url()+method,{user:user_id}).then(function(error,result){return promise.done(error,result)}):promise.done({code:1,message:"Insuficient parameters",type:"Client"},null),promise},_errorParameters=function(){return this},_url=function(){return app.host.main+"/network/"},{following:following,followers:followers,friends:friends,check:check,follow:follow,unfollow:unfollow,search:search,shieldFollow:shieldFollow}}(Appnima),Appnima.Payments=function(app){var confirm,createCreditCard,deleteCreditCard,getCreditCards,getPurchases,purchase,searchPurchases,updateCreditCard,_errorParameters,_url;return getCreditCards=function(){return app.connect("GET",""+_url()+"creditcard")},createCreditCard=function(parameters){return app.connect("POST",""+_url()+"creditcard",parameters)},deleteCreditCard=function(parameters){return app.connect("DELETE",""+_url()+"creditcard",parameters)},updateCreditCard=function(parameters){return app.connect("PUT",""+_url()+"creditcard",parameters)},purchase=function(parameters){return app.connect("POST",""+_url()+"purchase",parameters)},getPurchases=function(parameters){return app.connect("GET",""+_url()+"purchase",parameters)},confirm=function(parameters){return app.connect("POST",""+_url()+"confirm",parameters)},searchPurchases=function(parameters){return app.connect("GET",""+_url()+"purchase/search",parameters)},_errorParameters=function(){return this},_url=function(){return app.host.main+"/payments/"},{getCreditCards:getCreditCards,createCreditCard:createCreditCard,deleteCreditCard:deleteCreditCard,updateCreditCard:updateCreditCard,purchase:purchase,confirm:confirm,getPurchases:getPurchases,searchPurchase:searchPurchases}}(Appnima),Appnima.Network.Post=function(app){var comments,counter,create,createComment,deleteComment,get,like,likeUsers,remove,search,timeline,update,updateComment,userLike,_url;return create=function(parameters){return app.connect("POST",""+_url()+"post",parameters)},update=function(parameters){return app.connect("PUT",""+_url()+"post",parameters)},remove=function(id){return app.connect("DELETE",""+_url()+"post",{id:id})},get=function(id){return app.connect("GET",""+_url()+"post",{id:id})},search=function(parameters){return app.connect("GET",""+_url()+"post/search",parameters)},counter=function(id){var parameters;return parameters={},id&&(parameters.user=id),app.connect("GET",""+_url()+"post/user",parameters)},timeline=function(parameters){return app.connect("GET",""+_url()+"post/timeline",parameters)},comments=function(id){return app.connect("GET",""+_url()+"post/comment",{id:id})},createComment=function(parameters){return app.connect("POST",""+_url()+"post/comment",parameters)},updateComment=function(parameters){return app.connect("PUT",""+_url()+"post/comment",parameters)},deleteComment=function(id){return app.connect("DELETE",""+_url()+"post/comment",{id:id})},likeUsers=function(post){return app.connect("GET",""+_url()+"post/like/users",{post:post})},userLike=function(parameters){return app.connect("GET",""+_url()+"post/user/like",parameters)},like=function(post){return app.connect("POST",""+_url()+"post/like",{post:post})},_url=function(){return app.host.main+"/network/"},{create:create,update:update,remove:remove,search:search,counter:counter,get:get,timeline:timeline,comments:comments,createComment:createComment,deleteComment:deleteComment,likeUsers:likeUsers,userLike:userLike,like:like}}(Appnima),Appnima.Push=function(app){var received,send,_url;return send=function(user,alert,content){var parameters;return parameters={user:user,alert:alert,content:JSON.stringify(content)},app.connect("POST",_url(),parameters)},received=function(){return this},_url=function(){return app.host.main+"/push"},{send:send,received:received}}(Appnima),Appnima.Socket=function(){function Socket(id,type){var parameters;null==type&&(type=null),this.onMessage=__bind(this.onMessage,this),this.onDisconnect=__bind(this.onDisconnect,this),this.onError=__bind(this.onError,this),this.onDisallow=__bind(this.onDisallow,this),this.onConnect=__bind(this.onConnect,this),this.broadcast=__bind(this.broadcast,this),this.send=__bind(this.send,this),this.disallowUsers=__bind(this.disallowUsers,this),this.allowUsers=__bind(this.allowUsers,this),this.disconnect=__bind(this.disconnect,this),this.connect=__bind(this.connect,this),this.create=__bind(this.create,this),parameters={"force new connection":!0,port:3e3},this.socket=io.connect(_url(),parameters),null!=id&&this.connect(id,type),this.socket.on("connect",function(_this){return function(){return _this.connected=!0}}(this))}var _url;return Socket.prototype.create=function(id,type,persistent,name,allowedUsers){return null==persistent&&(persistent=!0),null==name&&(name=""),null==allowedUsers&&(allowedUsers=[]),this.connected?this.socket.emit("open",Appnima.token,id,name,type,persistent,allowedUsers):this.socket.on("connect",function(_this){return function(){return _this.connected=!0,_this.socket.emit("open",Appnima.token,id,name,type,persistent,allowedUsers)}}(this))},Socket.prototype.connect=function(id,type){return null==type&&(type=null),this.connected?this.socket.emit("join",Appnima.token,id,type):(this.connected=!0,this.socket.on("connect",function(_this){return function(){return _this.socket.emit("join",Appnima.token,id,type)}}(this)))},Socket.prototype.disconnect=function(){return this.socket.emit("leave")},Socket.prototype.allowUsers=function(users){return null==users&&(users=[]),this.socket.emit("allowUsers",users)},Socket.prototype.disallowUsers=function(users){return null==users&&(users=[]),this.socket.emit("disallowUsers",users)},Socket.prototype.send=function(message,type){return null==type&&(type=0),this.socket.emit("sendMessage",{content:message,type:type})},Socket.prototype.broadcast=function(message,type){return null==type&&(type=0),this.socket.emit("broadcastMessage",{content:message,type:type})},Socket.prototype.onConnect=function(callback){return this.socket.on("onConnect",function(message){return callback(message)})},Socket.prototype.onDisallow=function(callback){return this.socket.on("onDisallowUsers",function(users){return callback(users)})},Socket.prototype.onError=function(callback){return this.socket.on("onError",function(){return function(message){return callback(message)}}(this))},Socket.prototype.onDisconnect=function(callback){return this.socket.on("disconnect",callback)},Socket.prototype.onMessage=function(callback){return this.socket.on("onMessage",function(message){return callback(message)})},Socket.prototype.api=function(type,method,parameters){return Appnima.connect(type,""+Appnima.host.main+method,parameters)},_url=function(){return""+Appnima.host.socket+"/socket/"},Socket}(),Appnima.Socket.Group=function(_super){function Group(){return Group.__super__.constructor.apply(this,arguments)}return __extends(Group,_super),Group.prototype.create=function(name,users,persistent){return null==users&&(users=[]),null==persistent&&(persistent=!0),Group.__super__.create.call(this,null,"private",persistent,name,users)},Group.prototype.list=function(){return this.api("GET","/socket/room")},Group.prototype.remove=function(id){return this.api("DELETE","/socket/room",{id:id})},Group.prototype.rename=function(id,name){return this.api("PUT","/socket/room",{id:id,name:name})},Group.prototype.deleteUnreadCount=function(room){return this.api("DELETE","/socket/message/unread",{room:room})},Group.prototype.messages=function(room,page){return this.api("GET","/socket/message",{room:room,page:page})},Group}(Appnima.Socket),Appnima.Socket.Chat=function(_super){function Chat(){return Chat.__super__.constructor.apply(this,arguments)}return __extends(Chat,_super),Chat.prototype.create=function(name,users){return null==users&&(users=[]),Chat.__super__.create.call(this,name,users,!1)},Chat}(Appnima.Socket.Group),Appnima.Socket.Emiter=function(_super){function Emiter(id){Emiter.__super__.constructor.call(this,null),this.create(id,"public",!1,id)}return __extends(Emiter,_super),Emiter}(Appnima.Socket),Appnima.Socket.Listener=function(_super){function Listener(id){Listener.__super__.constructor.call(this,id,"public")}return __extends(Listener,_super),Listener}(Appnima.Socket),Appnima.Socket.Application=function(_super){function Application(){Application.__super__.constructor.call(this,null),this.connect(null,"application")}return __extends(Application,_super),Application}(Appnima.Socket),Appnima.Socket.Inbox=function(_super){function Inbox(){Inbox.__super__.constructor.call(this,null),this.create(null,"inbox",!1)}return __extends(Inbox,_super),Inbox.prototype.unreadCounts=function(){return this.api("GET","socket/message/unread")},Inbox.prototype.onOnlineFriends=function(callback){return null!=callback&&this.socket.on("onOnlineFriends",function(users){return callback(users)}),this.socket.emit("onlineFriends",Appnima.token)},Inbox.prototype.onFriendStatusChange=function(callback){return this.socket.on("friendStatusChange",function(user){return callback(user)})},Inbox.prototype.sendToUser=function(id,data){return this.socket.emit("sendToUser",Appnima.token,id,data)},Inbox}(Appnima.Socket),Appnima.Storage=function(app){var activityFile,allowAccessFile,createFolder,deleteFile,deleteFolder,denyAccessFile,dir,download,publicURLFile,renameFile,renameFolder,search,sharedFiles,upload,_url;return dir=function(folder){var parameters;return parameters=folder?{folder:folder}:null,app.connect("GET",""+_url()+"folder",parameters)},createFolder=function(parameters){return app.connect("POST",""+_url()+"folder",parameters)},renameFolder=function(parameters){return app.connect("PUT",""+_url()+"folder",parameters)},deleteFolder=function(path){return app.connect("DELETE",""+_url()+"folder",{path:path})},upload=function(parameters,callbacks){return null==callbacks&&(callbacks={}),parameters.path||(parameters.path="/"),app.connectMultipart("POST",""+_url()+"file",parameters,callbacks)},download=function(file_id){return window.location=""+_url()+"file/"+file_id+"_"+Appnima.token},activityFile=function(id_file){return app.connect("GET",""+_url()+"activity",{id_file:id_file})},renameFile=function(parameters){return app.connect("PUT",""+_url()+"file",parameters)},deleteFile=function(id){return app.connect("DELETE",""+_url()+"file",{id:id})},search=function(term){return app.connect("POST",""+_url()+"search",{term:term})},publicURLFile=function(parameters){return app.connect("POST",""+_url()+"file/share",parameters)},allowAccessFile=function(parameters){return app.connect("PUT",""+_url()+"file/allow",parameters)},denyAccessFile=function(parameters){return app.connect("PUT",""+_url()+"file/disallow",parameters)},sharedFiles=function(){return app.connect("GET",""+_url()+"shared")},_url=function(){return""+app.host.storage+"/"},{upload:upload,download:download,renameFile:renameFile,deleteFile:deleteFile,search:search,publicURLFile:publicURLFile,createFolder:createFolder,renameFolder:renameFolder,deleteFolder:deleteFolder,dir:dir,allowAccessFile:allowAccessFile,denyAccessFile:denyAccessFile,activityFile:activityFile,sharedFiles:sharedFiles}}(Appnima),Appnima.User=function(app){var avatar,changePassword,deleteTicket,getTicket,info,login,logout,rememberPassword,resetPassword,searchTickets,session,signup,subscribe,terminal,ticket,token,update,updateTicket,_credentials,_storage,_url;return signup=function(mail,password,username){var parameters,promise;return promise=new Hope.Promise,parameters={password:password,username:null!=username?username:mail},null!=mail&&(parameters.mail=mail),Hope.shield([function(){return app.connect("POST",""+_url()+"signup",parameters,token)},function(){return function(error,profile){var storage;return storage=_storage(profile),parameters.grant_type="refresh_token",parameters.refresh_token=profile.refresh_token,app.connect("POST",""+_url()+"token",parameters,!0)}}(this)]).then(function(){return function(error,token){return _credentials(promise,error,token)}}(this)),promise},token=function(){var parameters,promise,storage;return promise=new Hope.Promise,storage=_storage(),parameters={refresh_token:storage.refresh_token,grant_type:"refresh_token"},app.connect("POST",""+_url()+"token",parameters,!0).then(function(error,token){return _credentials(promise,error,token)}),promise},session=function(){var storage;return storage=JSON.parse(localStorage.getItem(app.key)),storage&&(Appnima.token=storage.access_token,app.connect("GET",""+_url()+"info").then(function(error,result){return _storage(result)})),storage},login=function(mail,password,username){var parameters,promise;return promise=new Hope.Promise,parameters={password:password},mail&&(parameters.mail=mail),username&&(parameters.username=username),app.connect("POST",""+_url()+"login",parameters,!0).then(function(error,profile){return _credentials(promise,error,profile)}),promise},logout=function(){var promise;return promise=new Hope.Promise,setTimeout(function(){return localStorage.removeItem(app.key),promise.done(null,{status:"ok"})},300),promise},info=function(id){return id?app.connect("GET",""+_url()+"info",{id:id}):app.connect("GET",""+_url()+"info")},update=function(data){return app.connect("PUT",""+_url()+"info",data)},avatar=function(data){return app.connect("POST",""+_url()+"avatar",{avatar:data},!1)},changePassword=function(old_password,new_password){var parameters;return parameters={old_password:old_password,new_password:new_password},app.connect("PUT",""+_url()+"password",parameters)},rememberPassword=function(token,domain,pwd_url){var parameters;return parameters={},parameters.token=token,domain&&(parameters.domain=domain),pwd_url&&(parameters.pwd_url=pwd_url),app.connect("POST",""+_url()+"remember/password",parameters)},resetPassword=function(code,password){var parameters;return parameters={code:code,password:password},app.connect("POST",""+_url()+"reset/password",parameters)},terminal=function(os,type,token,version){var method,parameters;return method="GET",parameters={},null!=os&&(method="POST",parameters={os:os,token:token,type:type,version:version}),app.connect(method,""+_url()+"terminal",parameters)},subscribe=function(mail){return app.connect("POST",""+_url()+"subscription",{mail:mail},!0)},ticket=function(parameters){return app.connect("POST",""+_url()+"ticket",parameters)},updateTicket=function(parameters){return app.connect("PUT",""+_url()+"ticket",parameters)},getTicket=function(parameters){return app.connect("GET",""+_url()+"ticket",parameters)},deleteTicket=function(id){return app.connect("DELETE",""+_url()+"ticket",{id:id})},searchTickets=function(parameters){return app.connect("GET",""+_url()+"ticket/search",parameters)},_url=function(){return app.host.main+"/user/"},_credentials=function(promise,error,result){return error?promise.done(error,null):promise.done(null,_storage(result))},_storage=function(extend){var attribute,storage;if(storage=JSON.parse(localStorage.getItem(app.key))||{},extend){for(attribute in extend)storage[attribute]=extend[attribute];localStorage.setItem(app.key,JSON.stringify(storage)),null!=storage.access_token&&(Appnima.token=storage.access_token)}return storage},{signup:signup,token:token,login:login,logout:logout,session:session,info:info,update:update,avatar:avatar,changePassword:changePassword,rememberPassword:rememberPassword,resetPassword:resetPassword,terminal:terminal,subscribe:subscribe,ticket:ticket,updateTicket:updateTicket,getTicket:getTicket,searchTickets:searchTickets}}(Appnima),Appnima.Rtc=function(){var CHUNK_LENGTH,ICE_SERVERS,IceCandidate,OPTIONS,PeerConnection,SessionDescription;return ICE_SERVERS={iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"},{url:"turn:95.85.59.155:3478?transport=udp"},{url:"turn:95.85.59.155:3478?transport=tcp"}]},OPTIONS={optional:[{RtpDataChannels:!0}]},CHUNK_LENGTH=1e3,PeerConnection=function(){var peer_connection,_ref;return new(peer_connection=null!=(_ref=window.mozRTCPeerConnection)?_ref:window.webkitRTCPeerConnection)(ICE_SERVERS,OPTIONS)},SessionDescription=function(remote){var session_description;
return new(session_description="undefined"!=typeof RTCSessionDescription&&null!==RTCSessionDescription?RTCSessionDescription:mozRTCSessionDescription)(remote)},IceCandidate=function(candidate){var ice_candidate,_ref;return new(ice_candidate=null!=(_ref=window.mozRTCIceCandidate)?_ref:window.RTCIceCandidate)(candidate)},{CHUNK_LENGTH:CHUNK_LENGTH,PeerConnection:PeerConnection,SessionDescription:SessionDescription,IceCandidate:IceCandidate}}(Appnima),Appnima.Peer=function(){function Peer(){this._answer=__bind(this._answer,this),this._status=__bind(this._status,this),this._offer=__bind(this._offer,this),this._refresh=__bind(this._refresh,this),this._hangUp=__bind(this._hangUp,this),this._connected=__bind(this._connected,this),this._ice=__bind(this._ice,this),this.onNewIceCandidate=__bind(this.onNewIceCandidate,this),this._sendChunckedFile=__bind(this._sendChunckedFile,this);var event,_i,_len,_ref;for(Appnima.Signaling=io.connect(Appnima.host.rtc+"/rtc/"),this.connected=!1,this.connected_user_id=null,this.callbacks={},this.pc=Appnima.Rtc.PeerConnection(),this.pc.onicecandidate=this.onNewIceCandidate,_ref=this.events,_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],Appnima.Signaling.on(event,this["_"+event]);this.connect()}var saveToDisk,_configureOptions,_uid;return Peer.prototype.events=["offer","answer","ice","connected","status","refresh","hangUp","error"],Peer.prototype.connect=function(){return Appnima.Signaling.emit("connect",Appnima.token)},Peer.prototype.addMedia=function(media){return this.media=media,this.pc.addStream(this.media),this.pc.onaddstream=function(_this){return function(event){return _this.trigger("remoteStream",event.stream)}}(this)},Peer.prototype.createChannel=function(){return this.fileChunks={},this.channel=this.pc.createDataChannel("RTCDataChannel",{reliable:!0}),this.channel.onmessage=function(_this){return function(event){var data;return data=JSON.parse(event.data),"object"===data.type&&_this.trigger("data",data.message),"file"===data.type&&(_this.fileChunks[data.uid]||(_this.fileChunks[data.uid]=[]),_this.fileChunks[data.uid].push(data.message),data.last)?(saveToDisk(_this.fileChunks[data.uid].join(""),data.name),delete _this.fileChunks[data.uid]):void 0}}(this)},Peer.prototype.offer=function(user_id,only_audio,only_text){var options;return null==only_audio&&(only_audio=!1),null==only_text&&(only_text=!1),this.offerer=!0,options=_configureOptions(only_text,only_audio),this.pc.createOffer(function(_this){return function(description){return _this.pc.setLocalDescription(description),Appnima.Signaling.emit("offer",user_id,description)}}(this),null,options)},Peer.prototype.accept=function(user_id,remote_description,only_audio,only_text){var options;return null==only_audio&&(only_audio=!1),null==only_text&&(only_text=!1),this.offerer=!1,options=_configureOptions(only_text,only_audio),this.pc.setRemoteDescription(Appnima.Rtc.SessionDescription(remote_description)),this.pc.createAnswer(function(_this){return function(description){return _this.pc.setLocalDescription(description),Appnima.Signaling.emit("answer",user_id,description)}}(this),null,options)},Peer.prototype.send=function(data){return this.channel?this.channel.send(JSON.stringify({type:"object",message:data})):(console.error("Channel not created yet"),console.debug("use <PeerName>.createChannel() before this call"))},Peer.prototype.sendFile=function(file){var reader,uid;return file?(reader=new FileReader,uid=_uid(),reader.onload=function(_this){return function(event){return _this._sendChunckedFile(event,file.name,uid)}}(this),reader.readAsDataURL(file)):console.error("Not file provided")},Peer.prototype.hangUp=function(user_id,stream){return null==user_id&&(user_id=null),null==stream&&(stream=null),Appnima.Signaling.emit("hangUp",user_id),null!=stream?this.refreshConnection(stream):void 0},Peer.prototype.refreshFriendsList=function(){return Appnima.Signaling.emit("refresh")},Peer.prototype.statusChange=function(available){return null==available&&(available=!0),Appnima.Signaling.emit("status",available)},Peer.prototype.disconnect=function(){return Appnima.Signaling.emit("disconnect")},Peer.prototype.refreshConnection=function(stream){return null!=stream&&stream.stop(),this.pc.close(),this.pc=Appnima.Rtc.PeerConnection(),this.pc.onicecandidate=this.onNewIceCandidate,this.createChannel()},Peer.prototype._sendChunckedFile=function(event,name,uid,text){var data,remainingDataURL;return text||(text=event.target.result),data={type:"file",name:name,uid:uid},text.length>Appnima.Rtc.CHUNK_LENGTH?data.message=text.slice(0,Appnima.Rtc.CHUNK_LENGTH):(data.message=text,data.last=!0),this.channel.send(JSON.stringify(data)),remainingDataURL=text.slice(data.message.length),remainingDataURL.length?setTimeout(function(_this){return function(){return _this._sendChunckedFile(null,name,uid,remainingDataURL)}}(this),500):void 0},saveToDisk=function(fileUrl,fileName){var evt,save;return save=document.createElement("a"),save.href=fileUrl,save.target="_blank",save.download=fileName||fileUrl,evt=document.createEvent("MouseEvents"),evt.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),save.dispatchEvent(evt),(window.URL||window.webkitURL).revokeObjectURL(save.href)},Peer.prototype.onNewIceCandidate=function(ice){return ice.candidate&&!this.offerer?(this.pc.addIceCandidate(Appnima.Rtc.IceCandidate(ice.candidate)),Appnima.Signaling.emit("ice",this.connected_user_id,ice)):void 0},Peer.prototype._ice=function(ice){return this.offerer&&ice.candidate?this.pc.addIceCandidate(Appnima.Rtc.IceCandidate(ice.candidate)):void 0},Peer.prototype._connected=function(friends){return this.connected=!0,this.trigger("connected",friends)},Peer.prototype._hangUp=function(friend){return this.trigger("hangUp",friend)},Peer.prototype._refresh=function(friends){return this.trigger("refresh",friends)},Peer.prototype._offer=function(data){return this.connected_user_id=data.user.id,this.trigger("offer",data)},Peer.prototype._status=function(type,friend){return this.trigger(type,friend)},Peer.prototype._answer=function(data){return this.pc.setRemoteDescription(Appnima.Rtc.SessionDescription(data.description)),this.trigger("answer",data)},Peer.prototype._error=function(error){return console.error("[ERROR] :: ",error)},Peer.prototype.on=function(event,callback){return this.callbacks[event]=callback},Peer.prototype.trigger=function(event,data){return this.callbacks[event]?this.callbacks[event].call(this.callbacks[event],data):void 0},_configureOptions=function(only_text,only_audio){var channels;return channels=only_text===!0?{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}:only_audio===!0?{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},{optional:[],mandatory:channels}},_uid=function(length){var i,possible,text,_i;for(null==length&&(length=20),text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=_i=0;length>=0?length>=_i:_i>=length;i=length>=0?++_i:--_i)text+=possible.charAt(Math.floor(Math.random()*possible.length));return text},Peer}()}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Atoms.Organism.AppnimaProfile=function(_super){function AppnimaProfile(){return this.onFormChange=__bind(this.onFormChange,this),AppnimaProfile.__super__.constructor.apply(this,arguments)}return __extends(AppnimaProfile,_super),AppnimaProfile["extends"]=!0,AppnimaProfile.events=["error","change","logout"],AppnimaProfile["default"]={children:[{"Atom.Figure":{id:"avatar",style:"big",events:["touch"]}},{"Atom.Heading":{id:"mail"}},{"Molecule.Form":{id:"form",style:"margin-all",events:["change","error","submit"],children:[{"Atom.Input":{id:"username",type:"text",name:"username",placeholder:"Username..."}},{"Atom.Label":{text:"Other Information"}},{"Atom.Input":{id:"name",type:"text",name:"name",placeholder:"Name..."}},{"Atom.Input":{id:"phone",type:"tel",name:"phone",placeholder:"Phone..."}},{"Atom.Input":{id:"site",type:"text",name:"site",placeholder:"Site..."}},{"Atom.Button":{text:"Update profile",style:"margin-top fluid accept"}},{"Atom.Button":{text:"Logout",style:"fluid",callbacks:["onLogout"]}},{"Atom.Input":{id:"file",type:"file",events:["change"],callbacks:["onAvatarChange"]}}]}}]},AppnimaProfile.prototype.file=void 0,AppnimaProfile.prototype.render=function(){return AppnimaProfile.__super__.render.apply(this,arguments),null==window.Appnima?alert("ERROR: App/nima library not exists."):void 0},AppnimaProfile.prototype.show=function(){var field,session,value,_ref;if(AppnimaProfile.__super__.show.apply(this,arguments),session=Appnima.User.session()){this.avatar.refresh({url:session.avatar}),this.mail.refresh({text:session.mail});for(field in session)value=session[field],value&&null!=(_ref=this.form[field])&&_ref.value(value);return this.onFormChange()}},AppnimaProfile.prototype.onFigureTouch=function(){return this.form.file.el.trigger("click"),!1},AppnimaProfile.prototype.onAvatarChange=function(){var file_url,reader,_ref;return event.stopPropagation(),event.preventDefault(),file_url=event.target.files[0],(null!=file_url&&null!=(_ref=file_url.type)?_ref.match(/image.*/):void 0)&&(reader=new FileReader,reader.onerror=function(event){return alert("Error code: "+event.target.error)},reader.onload=function(_this){return function(event){return _this.file=event.target.result,_this.avatar.refresh({url:_this.file}),_this.onFormSubmit()}}(this),reader.readAsDataURL(file_url)),!1},AppnimaProfile.prototype.onFormChange=function(){var child,form,method,_i,_len,_ref;for(form=this.form.value(),method=""===form.mail?"attr":"removeAttr",_ref=this.form.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],child.value||child.el[method]("disabled",!0);return!1},AppnimaProfile.prototype.onFormError=function(){return this.bubble("error",form),!1},AppnimaProfile.prototype.onFormSubmit=function(event,form){var parameters,_ref;return null!=(null!=(_ref=window.Appnima)?_ref.key:void 0)&&(parameters=(null!=form?form.value():void 0)||{},null!=this.file&&(parameters.avatar=this.file),__.Modal.Loading.show(),window.Appnima.User.update(parameters).then(function(_this){return function(error,result){return error?_this.bubble("error",error):_this.bubble("change",result),__.Modal.Loading.hide()}}(this))),!1},AppnimaProfile.prototype.onLogout=function(){return Appnima.User.logout().then(function(_this){return function(error,result){return _this.bubble("logout",result)}}(this))},AppnimaProfile}(Atoms.Organism.Section),Atoms.Organism.AppnimaSession=function(_super){function AppnimaSession(){return this.onFormChange=__bind(this.onFormChange,this),AppnimaSession.__super__.constructor.apply(this,arguments)}return __extends(AppnimaSession,_super),AppnimaSession["extends"]=!0,AppnimaSession.events=["login","signup","error"],AppnimaSession["default"]={style:"padding",children:[{"Atom.Image":{}},{"Molecule.Form":{id:"form",events:["change"],children:[{"Atom.Input":{id:"mail",type:"email",name:"mail",placeholder:"Email...",events:["keyup"],required:!0}},{"Atom.Input":{id:"password",type:"password",name:"password",placeholder:"Password...",events:["keyup"],required:!0}},{"Atom.Button":{text:"Login",action:"login",style:"fluid theme",callbacks:["onSubmit"]}},{"Atom.Button":{text:"Signup",action:"signup",style:"fluid",callbacks:["onSubmit"]}}]}},{"Atom.Heading":{text:"© All Rights Reserved"}}]},AppnimaSession.prototype.render=function(){return AppnimaSession.__super__.render.apply(this,arguments),null!=window.Appnima?this.onFormChange():alert("ERROR: App/nima library not exists.")},AppnimaSession.prototype.onFormChange=function(){var child,form,method,_i,_len,_ref;for(form=this.form.value(),method=""===form.mail||""===form.password?"attr":"removeAttr",_ref=this.form.children,_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],child.value||child.el[method]("disabled",!0);return!1},AppnimaSession.prototype.onSubmit=function(event,button){var action,values,_ref;return null!=(null!=(_ref=window.Appnima)?_ref.key:void 0)?(action=button.attributes.action,values=this.form.value(),__.Modal.Loading.show(),window.Appnima.User[action](values.mail,values.password).then(function(_this){return function(error,appnima){return error?_this.bubble("error",error):_this.bubble(action,appnima),__.Modal.Loading.hide()}}(this))):alert("ERROR: Unknown App/nima key")},AppnimaSession}(Atoms.Organism.Section)}.call(this),function(){"use strict";var __loadScript,__markerIcon,__parseAddress,__parseRouteSteps,__queryPlace,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Atoms.Atom.GMap=function(_super){function GMap(){return this.__init=__bind(this.__init,this),GMap.__super__.constructor.apply(this,arguments)}return __extends(GMap,_super),GMap.template='<div {{#if.style}}class="{{style}}"{{/if.style}}>\n  <span class="icon loading-d"></span>\n</div>',GMap.base="GMap",GMap.events=["query","route"],GMap.prototype._map=null,GMap.prototype._markers=[],GMap.prototype._query=[],GMap.prototype._route=null,GMap.prototype.output=function(){var exists;return GMap.__super__.output.apply(this,arguments),exists=Atoms.$("[data-extension=gmap]").length>0,exists?this.__init():__loadScript(this.__init)},GMap.prototype.center=function(position,zoom_level){return null==zoom_level&&(zoom_level=8),this._map.setCenter(new google.maps.LatLng(position.latitude,position.longitude)),this.zoom(zoom_level)},GMap.prototype.zoom=function(level){return this._map.setZoom(level)},GMap.prototype.query=function(value){var parameters,service;return parameters={},"string"!=typeof value?parameters.latLng=__queryPlace(value):parameters.address=value,this._query=[],service=new google.maps.Geocoder,service.geocode(parameters,function(_this){return function(results,status){var result;return status===google.maps.GeocoderStatus.OK&&(_this._query=function(){var _i,_len,_results;for(_results=[],_i=0,_len=results.length;_len>_i;_i++)result=results[_i],_results.push(__parseAddress(result));return _results}()),_this.bubble("query",_this._query)}}(this)),!0},GMap.prototype.marker=function(position,icon,animate){var marker;return null==animate&&(animate=!1),marker=new google.maps.Marker({map:this._map,icon:__markerIcon(icon),position:new google.maps.LatLng(position.latitude,position.longitude)}),animate&&marker.setAnimation(google.maps.Animation.BOUNCE),this._markers.push(marker),!0},GMap.prototype.route=function(origin,destination,mode,markers){var parameters,service;return null==mode&&(mode="DRIVING"),this.clean(),service=new google.maps.DirectionsService,parameters={origin:__queryPlace(origin),destination:__queryPlace(destination),travelMode:google.maps.TravelMode.DRIVING},service.route(parameters,function(_this){return function(_route,status){return _this._route=_route,status===google.maps.DirectionsStatus.OK?(parameters={suppressMarkers:null!=markers},_this._route.renderer=new google.maps.DirectionsRenderer(parameters),_this._route.renderer.setMap(_this._map),_this._route.renderer.setDirections(_this._route),markers&&_this.__markersInRoute(markers),_this.bubble("route",_this._route)):void 0}}(this)),!0},GMap.prototype.routeInstructions=function(){var instructions,_ref,_ref1;return instructions=null!=(_ref=this._route)&&null!=(_ref1=_ref.routes[0])?_ref1.legs[0]:void 0,instructions&&(instructions={distance:instructions.distance.text,duration:instructions.duration.text,steps:__parseRouteSteps(instructions)}),instructions},GMap.prototype.clean=function(){var marker,_i,_len,_ref,_ref1;for(_ref=this._markers,_i=0,_len=_ref.length;_len>_i;_i++)marker=_ref[_i],marker.setMap(null);return this._markers=[],null!=(_ref1=this._route)&&_ref1.renderer.setMap(null),this._route=null},GMap.prototype.__init=function(){return setTimeout(function(_this){return function(){var options;return options={center:new google.maps.LatLng(43.256963,-2.923441),zoom:1,mobile:!0,sensor:!1,disableDefaultUI:!0},_this._map=new google.maps.Map(_this.el[0],options)}}(this),1e3)},GMap.prototype.__markersInRoute=function(markers){var end,instructions,start,_ref,_ref1;return instructions=null!=(_ref=this._route)&&null!=(_ref1=_ref.routes[0])?_ref1.legs[0]:void 0,markers.origin&&(start=instructions.start_location,console.log("origin",markers.origin),this.marker({latitude:start.k,longitude:start.A},markers.origin)),markers.destination?(end=instructions.end_location,this.marker({latitude:end.k,longitude:end.A},markers.destination)):void 0},GMap}(Atoms.Class.Atom),__loadScript=function(callback){var script;return window.google={maps:{}},script=document.createElement("script"),script.type="text/javascript",script.src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&callback=console.log",script.setAttribute("data-extension","gmap"),script.onload=function(){return null!=callback?callback.call(this):void 0},document.body.appendChild(script)},__loadScript(),__markerIcon=function(icon){return icon?new google.maps.MarkerImage(icon.url,new google.maps.Size(icon.size_x,icon.size_y),new google.maps.Point(0,0),new google.maps.Point(icon.anchor_x,icon.anchor_y)):null},__queryPlace=function(value){return"string"!=typeof value&&(value=null!=value.latitude&&null!=value.longitude?new google.maps.LatLng(value.latitude,value.longitude):null),value},__parseAddress=function(address){return{address:address.formatted_address,type:address.types[0],position:{latitude:address.geometry.location.k,longitude:address.geometry.location.A}}},__parseRouteSteps=function(instructions){var step,steps,_i,_len,_ref;for(steps=[],_ref=instructions.steps,_i=0,_len=_ref.length;_len>_i;_i++)step=_ref[_i],steps.push({distance:step.distance.text,duration:step.duration.text,instructions:step.instructions});return steps},Atoms.Organism.GMap=function(_super){function GMap(){return GMap.__super__.constructor.apply(this,arguments)}return __extends(GMap,_super),GMap["extends"]=!0,GMap.available=["Atom.Input","Atom.Button","Atom.GMap","Molecule.Form"],GMap.events=["menu"],GMap["default"]={style:"menu form",children:[{"Atom.GMap":{id:"instance",events:["query"]}},{"Atom.Button":{icon:"navicon",style:"small"}},{"Molecule.Form":{events:["submit"],children:[{"Atom.Input":{name:"address",placeholder:"Type a address",required:!0}},{"Atom.Button":{icon:"search",text:"Search",style:"fluid accept"}}]}}]},GMap.prototype.onFormSubmit=function(event,form){return event.preventDefault(),this.instance.query(form.value().address),!1},GMap.prototype.onGMapQuery=function(places){var zoom;return this.instance.clean(),places.length>0&&(this.instance.marker(places[0].position),this.instance.center(places[0].position,zoom=16)),!1},GMap.prototype.onButtonTouch=function(event){return event.preventDefault(),this.bubble("menu",event),!1},GMap}(Atoms.Organism.Section)}.call(this);